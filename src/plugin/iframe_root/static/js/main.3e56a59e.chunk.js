(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{130:function(e,t,r){e.exports=r(251)},135:function(e,t,r){},141:function(e,t,r){},195:function(e,t,r){},197:function(e,t,r){},199:function(e,t,r){},211:function(e,t,r){},213:function(e,t,r){},215:function(e,t,r){},217:function(e,t,r){},219:function(e,t,r){},221:function(e,t,r){},225:function(e,t,r){},227:function(e,t,r){},251:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),i=r(10),o=r.n(i),s=(r(135),r(11)),c=r(12),u=r(14),l=r(13),E=r(15),d=r(252),m=r(259),p=r(254),h=r(19),O=r(50),R=r(116),g=r(7),v=(r(141),r(260)),f=r(39),_=r(258),S=r(261),A=function(e){function t(e){var r;return Object(s.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={searchTerms:[]},r}return Object(E.a)(t,e),Object(c.a)(t,[{key:"getAvatarUrl",value:function(e){if(!e.gravatarHash)return"unicorn-64.png";return"https://www.gravatar.com/avatar/"+e.gravatarHash+"?s=64&amp;r=pg&d=identicon"}},{key:"renderAvatar",value:function(e){return n.createElement("img",{style:{width:64,height:64},src:this.getAvatarUrl(e)})}},{key:"renderRelation",value:function(e){switch(e.relation.type){case D.NONE:return n.createElement("span",null,n.createElement(f.a,{type:"stop"}),"None");case D.VIEW:return n.createElement(_.a,{placement:"bottomRight",mouseEnterDelay:.5,title:"You are not a member of this org, but you may access it; you may request membership"},n.createElement("span",null,n.createElement(f.a,{type:"eye"}),"View"));case D.MEMBER_REQUEST_PENDING:return n.createElement("span",null,n.createElement(f.a,{type:"user",style:{color:"orange"}}),"Your membership request is pending");case D.MEMBER_INVITATION_PENDING:return n.createElement("span",null,n.createElement(f.a,{type:"user",style:{color:"blue"}}),"You have been invited to join");case D.MEMBER:return n.createElement("span",null,n.createElement(f.a,{type:"user"}),"Member");case D.ADMIN:return n.createElement("span",null,n.createElement(f.a,{type:"unlock"}),"Admin");case D.OWNER:return n.createElement(_.a,{placement:"bottomRight",mouseEnterDelay:.5,title:"You own this org"},n.createElement("span",null,n.createElement(f.a,{type:"unlock",theme:"filled"}),"Owner"))}}},{key:"renderAdminInfo",value:function(e){var t;if(e.relation.type===D.OWNER||e.relation.type===D.ADMIN)return e.adminRequests.length>0&&(t=n.createElement("div",null,n.createElement(f.a,{type:"exclamation-circle",theme:"twoTone",twoToneColor:"orange"}),"  group has ",n.createElement("b",null,e.adminRequests.length," pending request",e.adminRequests.length>1?"s":""))),n.createElement("div",{className:"admin"},t)}},{key:"pluralize",value:function(e,t,r){return 0===e||e>1?r:t}},{key:"renderOrg",value:function(e,t){return n.createElement("div",{className:"row organization",key:String(t)},n.createElement("div",{className:"col2"},n.createElement(v.a,{to:"/viewOrganization/".concat(e.id)},this.renderAvatar(e))),n.createElement("div",{className:"col1"},n.createElement("div",{className:"orgName"},n.createElement(v.a,{to:"/viewOrganization/".concat(e.id)},e.name)),n.createElement("div",{className:"orgOwner"},n.createElement("span",{className:"field-label"},"owner"),n.createElement("span",{className:"field-value"},n.createElement("a",{href:"/#people/"+e.owner.username,target:"_blank"},e.owner.realname," \u2768",e.owner.username,"\u2769"))),n.createElement("div",{className:"orgCreated"},n.createElement("span",{className:"field-label"},"established"),n.createElement("span",{className:"field-value"},Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(e.createdAt))),n.createElement("div",{className:"memberCount"},e.members.length>0?e.members.length:"no"," ",this.pluralize(e.members.length,"member","members")),n.createElement("div",{className:"relation"},n.createElement("span",{className:"field-label"},"you"),this.renderRelation(e)),this.renderAdminInfo(e)))}},{key:"renderOrgs",value:function(){var e=this;return this.props.organizations.length>0?this.props.organizations.map(function(t,r){return e.renderOrg(t,r)}):n.createElement(S.a,{type:"warning",style:{maxWidth:"20em",margin:"20px auto 0 auto"},message:"Sorry, no organizations were found."})}},{key:"render",value:function(){return n.createElement("div",{className:"Organizations"},this.renderOrgs())}}]),t}(n.Component);var T,D,N,y,I,w,U,C,b,G,k,z,P,j,H,M=Object(h.b)(function(e){return{organizations:e.browseOrgs.organizations}})(A);!function(e){e[e.NONE=0]="NONE",e[e.INFO=1]="INFO",e[e.WARNING=2]="WARNING",e[e.ERROR=3]="ERROR"}(T||(T={})),function(e){e[e.NONE=0]="NONE",e[e.VIEW=1]="VIEW",e[e.MEMBER_REQUEST_PENDING=2]="MEMBER_REQUEST_PENDING",e[e.MEMBER_INVITATION_PENDING=3]="MEMBER_INVITATION_PENDING",e[e.MEMBER=4]="MEMBER",e[e.ADMIN=5]="ADMIN",e[e.OWNER=6]="OWNER"}(D||(D={})),function(e){e[e.JOIN_GROUP_REQUEST=0]="JOIN_GROUP_REQUEST",e[e.JOIN_GROUP_INVITE=1]="JOIN_GROUP_INVITE",e[e.ADD_WORKSPACE_INVITE=2]="ADD_WORKSPACE_INVITE",e[e.ADD_WORKSPACE_REQUEST=3]="ADD_WORKSPACE_REQUEST"}(N||(N={})),function(e){e[e.OPEN=0]="OPEN",e[e.CANCELED=1]="CANCELED",e[e.EXPIRED=2]="EXPIRED",e[e.ACCEPTED=3]="ACCEPTED",e[e.DENIED=4]="DENIED"}(y||(y={})),function(e){e[e.NONE=0]="NONE",e[e.CHECKING=1]="CHECKING",e[e.AUTHORIZED=2]="AUTHORIZED",e[e.UNAUTHORIZED=3]="UNAUTHORIZED",e[e.ERROR=4]="ERROR"}(I||(I={})),function(e){e[e.NONE=0]="NONE",e[e.FETCHING=1]="FETCHING",e[e.READY=2]="READY",e[e.EDITING_CAN_SAVE=3]="EDITING_CAN_SAVE",e[e.EDITING_ERRORS=4]="EDITING_ERRORS",e[e.SAVING=5]="SAVING",e[e.SAVED=6]="SAVED",e[e.ERROR=7]="ERROR"}(w||(w={})),function(e){e.NONE="NONE",e.NEW="NEW",e.DIRTY="DIRTY",e.CLEAN="CLEAN"}(U||(U={})),function(e){e.NONE="NONE",e.UNEDITED="UNEDITED",e.EDITED="EDITED"}(C||(C={})),function(e){e.NONE="NONE",e.NEW="NEW",e.READY="READY",e.SAVING="SAVING",e.SAVED="SAVED",e.SAVE_ERROR="SAVE_ERROR"}(b||(b={})),function(e){e.NONE="NONE",e.VALID="VALID",e.INVALID="INVALID"}(G||(G={})),function(e){e[e.NONE=0]="NONE",e[e.UNEDITED_OK=1]="UNEDITED_OK",e[e.UNEDITED_ERROR=2]="UNEDITED_ERROR",e[e.EDITED_OK=3]="EDITED_OK",e[e.EDITED_ERROR=4]="EDITED_ERROR",e[e.EDITED_WARNING=5]="EDITED_WARNING"}(k||(k={})),function(e){e[e.NONE=0]="NONE",e[e.INITIAL=1]="INITIAL",e[e.FETCHING=2]="FETCHING",e[e.READY=3]="READY",e[e.ERROR=4]="ERROR"}(z||(z={})),function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.READY=2]="READY",e[e.ERROR=3]="ERROR"}(P||(P={})),function(e){e.ASCENDING="asc",e.DESCENDING="desc"}(j||(j={})),function(e){e[e.APP=1]="APP",e[e.APP_START=2]="APP_START",e[e.APP_SUCCESS=3]="APP_SUCCESS",e[e.APP_ERROR=4]="APP_ERROR",e[e.SORT_ORGS=5]="SORT_ORGS",e[e.SORT_ORGS_START=6]="SORT_ORGS_START",e[e.FILTER_ORGS=7]="FILTER_ORGS",e[e.FILTER_ORGS_START=8]="FILTER_ORGS_START",e[e.SEARCH_ORGS=9]="SEARCH_ORGS",e[e.SEARCH_ORGS_START=10]="SEARCH_ORGS_START",e[e.SEARCH_ORGS_SUCCESS=11]="SEARCH_ORGS_SUCCESS",e[e.SEARCH_ORGS_ERROR=12]="SEARCH_ORGS_ERROR",e[e.UPDATE_ORG=13]="UPDATE_ORG",e[e.UPDATE_ORG_START=14]="UPDATE_ORG_START",e[e.UPDATE_ORG_SUCCESS=15]="UPDATE_ORG_SUCCESS",e[e.UPDATE_ORG_ERROR=16]="UPDATE_ORG_ERROR",e[e.VIEW_ORG_FETCH=17]="VIEW_ORG_FETCH",e[e.VIEW_ORG_FETCH_START=18]="VIEW_ORG_FETCH_START",e[e.VIEW_ORG_FETCH_SUCCESS=19]="VIEW_ORG_FETCH_SUCCESS",e[e.VIEW_ORG_FETCH_ERROR=20]="VIEW_ORG_FETCH_ERROR",e[e.VIEW_ORG_STOP=21]="VIEW_ORG_STOP",e[e.VIEW_ORG_JOIN_REQUEST=22]="VIEW_ORG_JOIN_REQUEST",e[e.VIEW_ORG_JOIN_REQUEST_START=23]="VIEW_ORG_JOIN_REQUEST_START",e[e.VIEW_ORG_JOIN_REQUEST_SUCCESS=24]="VIEW_ORG_JOIN_REQUEST_SUCCESS",e[e.VIEW_ORG_JOIN_REQUEST_ERROR=25]="VIEW_ORG_JOIN_REQUEST_ERROR",e[e.VIEW_ORG_CANCEL_JOIN_REQUEST=26]="VIEW_ORG_CANCEL_JOIN_REQUEST",e[e.VIEW_ORG_CANCEL_JOIN_REQUEST_START=27]="VIEW_ORG_CANCEL_JOIN_REQUEST_START",e[e.VIEW_ORG_CANCEL_JOIN_REQUEST_SUCCESS=28]="VIEW_ORG_CANCEL_JOIN_REQUEST_SUCCESS",e[e.VIEW_ORG_CANCEL_JOIN_REQUEST_ERROR=29]="VIEW_ORG_CANCEL_JOIN_REQUEST_ERROR",e[e.ADD_ORG_EDIT=30]="ADD_ORG_EDIT",e[e.ADD_ORG_EDIT_START=31]="ADD_ORG_EDIT_START",e[e.ADD_ORG_EDIT_FINISH=32]="ADD_ORG_EDIT_FINISH",e[e.ADD_ORG_UPDATE_NAME=33]="ADD_ORG_UPDATE_NAME",e[e.ADD_ORG_UPDATE_NAME_SUCCESS=34]="ADD_ORG_UPDATE_NAME_SUCCESS",e[e.ADD_ORG_UPDATE_NAME_ERROR=35]="ADD_ORG_UPDATE_NAME_ERROR",e[e.ADD_ORG_UPDATE_GRAVATAR_HASH=36]="ADD_ORG_UPDATE_GRAVATAR_HASH",e[e.ADD_ORG_UPDATE_GRAVATAR_HASH_SUCCESS=37]="ADD_ORG_UPDATE_GRAVATAR_HASH_SUCCESS",e[e.ADD_ORG_UPDATE_GRAVATAR_HASH_ERROR=38]="ADD_ORG_UPDATE_GRAVATAR_HASH_ERROR",e[e.ADD_ORG_UPDATE_ID=39]="ADD_ORG_UPDATE_ID",e[e.ADD_ORG_UPDATE_ID_SUCCESS=40]="ADD_ORG_UPDATE_ID_SUCCESS",e[e.ADD_ORG_UPDATE_ID_ERROR=41]="ADD_ORG_UPDATE_ID_ERROR",e[e.ADD_ORG_UPDATE_DESCRIPTION=42]="ADD_ORG_UPDATE_DESCRIPTION",e[e.ADD_ORG_UPDATE_DESCRIPTION_SUCCESS=43]="ADD_ORG_UPDATE_DESCRIPTION_SUCCESS",e[e.ADD_ORG_UPDATE_DESCRIPTION_ERROR=44]="ADD_ORG_UPDATE_DESCRIPTION_ERROR",e[e.ADD_ORG_EVALUATE=45]="ADD_ORG_EVALUATE",e[e.ADD_ORG_EVALUATE_OK=46]="ADD_ORG_EVALUATE_OK",e[e.ADD_ORG_EVALUATE_ERRORS=47]="ADD_ORG_EVALUATE_ERRORS",e[e.ADD_ORG=48]="ADD_ORG",e[e.ADD_ORG_START=49]="ADD_ORG_START",e[e.ADD_ORG_SUCCESS=50]="ADD_ORG_SUCCESS",e[e.ADD_ORG_ERROR=51]="ADD_ORG_ERROR",e[e.EDIT_ORG_EDIT=52]="EDIT_ORG_EDIT",e[e.EDIT_ORG_EDIT_START=53]="EDIT_ORG_EDIT_START",e[e.EDIT_ORG_EDIT_SUCCESS=54]="EDIT_ORG_EDIT_SUCCESS",e[e.EDIT_ORG_EDIT_ERROR=55]="EDIT_ORG_EDIT_ERROR",e[e.EDIT_ORG_SAVE=56]="EDIT_ORG_SAVE",e[e.EDIT_ORG_SAVE_START=57]="EDIT_ORG_SAVE_START",e[e.EDIT_ORG_SAVE_SUCCESS=58]="EDIT_ORG_SAVE_SUCCESS",e[e.EDIT_ORG_SAVE_ERROR=59]="EDIT_ORG_SAVE_ERROR",e[e.EDIT_ORG_UPDATE_NAME=60]="EDIT_ORG_UPDATE_NAME",e[e.EDIT_ORG_UPDATE_NAME_SUCCESS=61]="EDIT_ORG_UPDATE_NAME_SUCCESS",e[e.EDIT_ORG_UPDATE_NAME_ERROR=62]="EDIT_ORG_UPDATE_NAME_ERROR",e[e.EDIT_ORG_UPDATE_GRAVATAR_HASH=63]="EDIT_ORG_UPDATE_GRAVATAR_HASH",e[e.EDIT_ORG_UPDATE_GRAVATAR_HASH_SUCCESS=64]="EDIT_ORG_UPDATE_GRAVATAR_HASH_SUCCESS",e[e.EDIT_ORG_UPDATE_GRAVATAR_HASH_ERROR=65]="EDIT_ORG_UPDATE_GRAVATAR_HASH_ERROR",e[e.EDIT_ORG_UPDATE_DESCRIPTION=66]="EDIT_ORG_UPDATE_DESCRIPTION",e[e.EDIT_ORG_UPDATE_DESCRIPTION_SUCCESS=67]="EDIT_ORG_UPDATE_DESCRIPTION_SUCCESS",e[e.EDIT_ORG_UPDATE_DESCRIPTION_ERROR=68]="EDIT_ORG_UPDATE_DESCRIPTION_ERROR",e[e.EDIT_ORG_EVALUATE=69]="EDIT_ORG_EVALUATE",e[e.EDIT_ORG_EVALUATE_OK=70]="EDIT_ORG_EVALUATE_OK",e[e.EDIT_ORG_EVALUATE_ERRORS=71]="EDIT_ORG_EVALUATE_ERRORS",e[e.AUTH_CHECK=72]="AUTH_CHECK",e[e.AUTH_CHECK_START=73]="AUTH_CHECK_START",e[e.AUTH_CHECK_ERROR=74]="AUTH_CHECK_ERROR",e[e.AUTH_AUTHORIZED=75]="AUTH_AUTHORIZED",e[e.AUTH_UNAUTHORIZED=76]="AUTH_UNAUTHORIZED",e[e.AUTH_REMOVE_AUTHORIZATION=77]="AUTH_REMOVE_AUTHORIZATION",e[e.AUTH_ADD_AUTHORIZATION=78]="AUTH_ADD_AUTHORIZATION",e[e.AUTH_ADD_AUTHORIZATION_ERROR=79]="AUTH_ADD_AUTHORIZATION_ERROR",e[e.ADMIN_MANAGE_REQUESTS=80]="ADMIN_MANAGE_REQUESTS",e[e.ADMIN_MANAGE_REQUESTS_START=81]="ADMIN_MANAGE_REQUESTS_START",e[e.ADMIN_MANAGE_REQUESTS_SUCCESS=82]="ADMIN_MANAGE_REQUESTS_SUCCESS",e[e.ADMIN_MANAGE_REQUESTS_ERROR=83]="ADMIN_MANAGE_REQUESTS_ERROR",e[e.ADMIN_MANAGE_REQUESTS_ACCEPT_JOIN_REQUEST=84]="ADMIN_MANAGE_REQUESTS_ACCEPT_JOIN_REQUEST",e[e.ADMIN_MANAGE_REQUESTS_ACCEPT_JOIN_REQUEST_START=85]="ADMIN_MANAGE_REQUESTS_ACCEPT_JOIN_REQUEST_START",e[e.ADMIN_MANAGE_REQUESTS_ACCEPT_JOIN_REQUEST_SUCCESS=86]="ADMIN_MANAGE_REQUESTS_ACCEPT_JOIN_REQUEST_SUCCESS",e[e.ADMIN_MANAGE_REQUESTS_ACCEPT_JOIN_REQUEST_ERROR=87]="ADMIN_MANAGE_REQUESTS_ACCEPT_JOIN_REQUEST_ERROR",e[e.ADMIN_MANAGE_REQUESTS_DENY_JOIN_REQUEST=88]="ADMIN_MANAGE_REQUESTS_DENY_JOIN_REQUEST",e[e.ADMIN_MANAGE_REQUESTS_DENY_JOIN_REQUEST_START=89]="ADMIN_MANAGE_REQUESTS_DENY_JOIN_REQUEST_START",e[e.ADMIN_MANAGE_REQUESTS_DENY_JOIN_REQUEST_SUCCESS=90]="ADMIN_MANAGE_REQUESTS_DENY_JOIN_REQUEST_SUCCESS",e[e.ADMIN_MANAGE_REQUESTS_DENY_JOIN_REQUEST_ERROR=91]="ADMIN_MANAGE_REQUESTS_DENY_JOIN_REQUEST_ERROR"}(H||(H={}));var V=function(e,t){switch(t.type){case H.ADD_ORG_START:return function(e,t){return Object(g.a)({},e,{addOrg:Object(g.a)({},e.addOrg,{saveState:b.SAVING})})}(e);case H.ADD_ORG_SUCCESS:return function(e,t){return Object(g.a)({},e,{addOrg:Object(g.a)({},e.addOrg,{editState:C.UNEDITED,saveState:b.SAVED})})}(e);case H.ADD_ORG_ERROR:return function(e,t){return Object(g.a)({},e,{addOrg:Object(g.a)({},e.addOrg,{saveState:b.SAVE_ERROR,error:t.error})})}(e,t);case H.ADD_ORG_EDIT_START:return function(e,t){return Object(g.a)({},e,{addOrg:Object(g.a)({},e.addOrg,{editState:C.UNEDITED,validationState:G.NONE,saveState:b.NEW,newOrganization:{id:{value:"",status:k.NONE,error:{type:T.NONE}},name:{value:"",status:k.NONE,error:{type:T.NONE}},gravatarHash:{value:"",status:k.NONE,error:{type:T.NONE}},description:{value:"",status:k.NONE,error:{type:T.NONE}}}})})}(e);case H.ADD_ORG_EDIT_FINISH:return function(e,t){return Object(g.a)({},e,{addOrg:Object(g.a)({},e.addOrg,{editState:C.UNEDITED})})}(e);case H.ADD_ORG_UPDATE_NAME_SUCCESS:return function(e,t){return Object(g.a)({},e,{addOrg:Object(g.a)({},e.addOrg,{editState:C.EDITED,newOrganization:Object(g.a)({},e.addOrg.newOrganization,{name:{value:t.name,status:k.EDITED_OK,error:{type:T.NONE}}})})})}(e,t);case H.ADD_ORG_UPDATE_NAME_ERROR:return function(e,t){return Object(g.a)({},e,{addOrg:Object(g.a)({},e.addOrg,{editState:C.EDITED,newOrganization:Object(g.a)({},e.addOrg.newOrganization,{name:{value:t.name,status:k.EDITED_ERROR,error:t.error}})})})}(e,t);case H.ADD_ORG_UPDATE_GRAVATAR_HASH_SUCCESS:return function(e,t){return Object(g.a)({},e,{addOrg:Object(g.a)({},e.addOrg,{editState:C.EDITED,newOrganization:Object(g.a)({},e.addOrg.newOrganization,{gravatarHash:{value:t.gravatarHash,status:k.EDITED_OK,error:{type:T.NONE}}})})})}(e,t);case H.ADD_ORG_UPDATE_GRAVATAR_HASH_ERROR:return function(e,t){return Object(g.a)({},e,{addOrg:Object(g.a)({},e.addOrg,{editState:C.EDITED,newOrganization:Object(g.a)({},e.addOrg.newOrganization,{gravatarHash:{value:t.gravatarHash,status:k.EDITED_ERROR,error:t.error}})})})}(e,t);case H.ADD_ORG_UPDATE_ID_SUCCESS:return function(e,t){return Object(g.a)({},e,{addOrg:Object(g.a)({},e.addOrg,{editState:C.EDITED,newOrganization:Object(g.a)({},e.addOrg.newOrganization,{id:{value:t.id,status:k.EDITED_OK,error:{type:T.NONE}}})})})}(e,t);case H.ADD_ORG_UPDATE_ID_ERROR:return function(e,t){return Object(g.a)({},e,{addOrg:Object(g.a)({},e.addOrg,{editState:C.EDITED,newOrganization:Object(g.a)({},e.addOrg.newOrganization,{id:{value:t.id,status:k.EDITED_ERROR,error:t.error}})})})}(e,t);case H.ADD_ORG_UPDATE_DESCRIPTION_SUCCESS:return function(e,t){return Object(g.a)({},e,{addOrg:Object(g.a)({},e.addOrg,{editState:C.EDITED,newOrganization:Object(g.a)({},e.addOrg.newOrganization,{description:{value:t.description,status:k.EDITED_OK,error:{type:T.NONE}}})})})}(e,t);case H.ADD_ORG_UPDATE_DESCRIPTION_ERROR:return function(e,t){return Object(g.a)({},e,{addOrg:Object(g.a)({},e.addOrg,{editState:C.EDITED,newOrganization:Object(g.a)({},e.addOrg.newOrganization,{description:{value:t.description,status:k.EDITED_ERROR,error:t.error}})})})}(e,t);case H.ADD_ORG_EVALUATE_OK:return function(e,t){return Object(g.a)({},e,{addOrg:Object(g.a)({},e.addOrg,{validationState:G.VALID})})}(e);case H.ADD_ORG_EVALUATE_ERRORS:return function(e,t){return Object(g.a)({},e,{addOrg:Object(g.a)({},e.addOrg,{validationState:G.INVALID})})}(e);default:return null}};var q=function(e,t){switch(t.type){case H.EDIT_ORG_EDIT_START:return function(e,t){return Object(g.a)({},e,{editOrg:Object(g.a)({},e.editOrg,{editState:C.UNEDITED,validationState:G.NONE,saveState:b.NEW,organizationId:t.id,editedOrganization:{id:{value:"",status:k.NONE,error:{type:T.NONE}},name:{value:"",status:k.NONE,error:{type:T.NONE}},gravatarHash:{value:"",status:k.NONE,error:{type:T.NONE}},description:{value:"",status:k.NONE,error:{type:T.NONE}}}})})}(e,t);case H.EDIT_ORG_EDIT_SUCCESS:return function(e,t){return Object(g.a)({},e,{editOrg:Object(g.a)({},e.editOrg,{editedOrganization:t.editedOrganization,editState:C.UNEDITED})})}(e,t);case H.EDIT_ORG_SAVE_START:return function(e,t){return Object(g.a)({},e,{editOrg:Object(g.a)({},e.editOrg,{saveState:b.SAVING})})}(e);case H.EDIT_ORG_SAVE_SUCCESS:return function(e,t){return Object(g.a)({},e,{editOrg:Object(g.a)({},e.editOrg,{editState:C.UNEDITED,saveState:b.SAVED})})}(e);case H.EDIT_ORG_SAVE_ERROR:return function(e,t){return Object(g.a)({},e,{editOrg:Object(g.a)({},e.editOrg,{saveState:b.SAVE_ERROR,error:t.error})})}(e,t);case H.EDIT_ORG_UPDATE_NAME_SUCCESS:return function(e,t){return Object(g.a)({},e,{editOrg:Object(g.a)({},e.editOrg,{editState:C.EDITED,editedOrganization:Object(g.a)({},e.editOrg.editedOrganization,{name:{value:t.name,status:k.EDITED_OK,error:{type:T.NONE}}})})})}(e,t);case H.EDIT_ORG_UPDATE_NAME_ERROR:return function(e,t){return Object(g.a)({},e,{editOrg:Object(g.a)({},e.editOrg,{editState:C.EDITED,editedOrganization:Object(g.a)({},e.editOrg.editedOrganization,{name:{value:t.name,status:k.EDITED_ERROR,error:t.error}})})})}(e,t);case H.EDIT_ORG_UPDATE_GRAVATAR_HASH_SUCCESS:return function(e,t){return Object(g.a)({},e,{editOrg:Object(g.a)({},e.editOrg,{editState:C.EDITED,editedOrganization:Object(g.a)({},e.editOrg.editedOrganization,{gravatarHash:{value:t.gravatarHash,status:k.EDITED_OK,error:{type:T.NONE}}})})})}(e,t);case H.EDIT_ORG_UPDATE_GRAVATAR_HASH_ERROR:return function(e,t){return Object(g.a)({},e,{editOrg:Object(g.a)({},e.editOrg,{editState:C.EDITED,editedOrganization:Object(g.a)({},e.editOrg.editedOrganization,{gravatarHash:{value:t.gravatarHash,status:k.EDITED_ERROR,error:t.error}})})})}(e,t);case H.EDIT_ORG_UPDATE_DESCRIPTION_SUCCESS:return function(e,t){return Object(g.a)({},e,{editOrg:Object(g.a)({},e.editOrg,{editState:C.EDITED,editedOrganization:Object(g.a)({},e.editOrg.editedOrganization,{description:{value:t.description,status:k.EDITED_OK,error:{type:T.NONE}}})})})}(e,t);case H.EDIT_ORG_UPDATE_DESCRIPTION_ERROR:return function(e,t){return Object(g.a)({},e,{editOrg:Object(g.a)({},e.editOrg,{editState:C.EDITED,editedOrganization:Object(g.a)({},e.editOrg.editedOrganization,{description:{value:t.description,status:k.EDITED_ERROR,error:t.error}})})})}(e,t);case H.EDIT_ORG_EVALUATE_OK:return function(e,t){return Object(g.a)({},e,{editOrg:Object(g.a)({},e.editOrg,{validationState:G.VALID})})}(e);case H.EDIT_ORG_EVALUATE_ERRORS:return function(e,t){return Object(g.a)({},e,{editOrg:Object(g.a)({},e.editOrg,{validationState:G.INVALID})})}(e);default:return null}};var x=function(e,t){switch(t.type){case H.VIEW_ORG_FETCH_START:return function(e,t){return Object(g.a)({},e,{viewOrg:Object(g.a)({},e.viewOrg,{state:z.FETCHING})})}(e);case H.VIEW_ORG_FETCH_SUCCESS:return function(e,t){return Object(g.a)({},e,{viewOrg:Object(g.a)({},e.viewOrg,{state:z.READY,organization:t.organization})})}(e,t);case H.VIEW_ORG_FETCH_ERROR:return function(e,t){return Object(g.a)({},e,{viewOrg:Object(g.a)({},e.viewOrg,{state:z.ERROR,error:t.error})})}(e,t);case H.VIEW_ORG_STOP:return function(e,t){return Object(g.a)({},e,{viewOrg:{state:z.NONE}})}(e);default:return null}};var L=function(e,t){switch(t.type){case H.SEARCH_ORGS_START:return function(e,t){var r=e.browseOrgs;return r.filter,r.sortBy,r.sortDirection,t.searchTerms,e.auth.authorization.username,Object(g.a)({},e,{browseOrgs:Object(g.a)({},e.browseOrgs,{searching:!0,searchTerms:t.searchTerms})})}(e,t);case H.SEARCH_ORGS_SUCCESS:return function(e,t){return Object(g.a)({},e,{browseOrgs:Object(g.a)({},e.browseOrgs,{searching:!1,organizations:t.organizations,totalCount:t.totalCount,filteredCount:t.organizations.length})})}(e,t);case H.SEARCH_ORGS_ERROR:return function(e,t){return Object(g.a)({},e,{error:t.error})}(e,t);case H.SORT_ORGS_START:return function(e,t){var r=e.browseOrgs;return r.searchTerms,r.filter,e.auth.authorization.username,t.sortBy,t.sortDirection,Object(g.a)({},e,{browseOrgs:Object(g.a)({},e.browseOrgs,{searching:!0,sortBy:t.sortBy,sortDirection:t.sortDirection})})}(e,t);case H.FILTER_ORGS_START:return function(e,t){var r=t.filter;return Object(g.a)({},e,{browseOrgs:Object(g.a)({},e.browseOrgs,{searching:!0,filter:r})})}(e,t);default:return null}};var W=function(e,t){switch(t.type){case H.AUTH_CHECK_START:return function(e,t){return Object(g.a)({},e,{auth:{status:I.CHECKING,message:"",authorization:{token:"",username:"",realname:"",roles:[]}}})}(e);case H.AUTH_AUTHORIZED:return function(e,t){return Object(g.a)({},e,{auth:{status:I.AUTHORIZED,message:"",authorization:{token:t.token,username:t.username,realname:t.realname,roles:t.roles}}})}(e,t);case H.AUTH_UNAUTHORIZED:return function(e,t){return Object(g.a)({},e,{auth:{status:I.UNAUTHORIZED,message:"",authorization:{token:"",username:"",realname:"",roles:[]}}})}(e);case H.AUTH_CHECK_ERROR:return function(e,t){return Object(g.a)({},e,{auth:{status:I.ERROR,message:t.error.message,authorization:{token:"",username:"",realname:"",roles:[]}}})}(e,t);default:return null}};var B=function(e,t){switch(t.type){case H.APP_SUCCESS:return function(e,t){return Object(g.a)({},e,{app:{status:P.READY,config:t.config}})}(e,t);default:return null}};var Q=function(e,t){switch(t.type){case H.ADMIN_MANAGE_REQUESTS_START:return function(e,t){return e}(e);case H.ADMIN_MANAGE_REQUESTS_SUCCESS:return function(e,t){return Object(g.a)({},e,{manageGroupRequestsView:{view:{organization:t.organization,requests:t.requests},error:null}})}(e,t);case H.ADMIN_MANAGE_REQUESTS_ERROR:return function(e,t){return Object(g.a)({},e,{manageGroupRequestsView:{view:null,error:t.error}})}(e,t);default:return null}};var J,F=function(e,t){return V(e,t)||q(e,t)||L(e,t)||x(e,t)||W(e,t)||B(e,t)||Q(e,t)||e},K=(r(195),r(119)),Y=r(91),Z=(r(197),r(257)),X=r(113),$=r(256),ee=(r(199),r(93)),te=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(c.a)(t,[{key:"buildSeparator",value:function(){if(this.props.children)return n.createElement(ee.a,{style:{verticalAlign:"middle",marginLeft:"4px",marginRight:"4px"}})}},{key:"render",value:function(){return n.createElement("div",{className:"Header"},n.createElement("div",{style:{flex:"0 0 auto"}},n.createElement(v.a,{to:"/organizations"},n.createElement(ee.b,{style:{verticalAlign:"middle"}})," ",n.createElement("span",{"data-test":"orgs-label"},"Orgs"))),n.createElement("div",{style:{flex:"1 1 0px",display:"flex",flexDirection:"row",alignItems:"center"}},this.buildSeparator(),this.props.children))}}]),t}(n.Component),re=function(e){function t(e){var r;return Object(s.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).searchInput=n.createRef(),r.searchButton=n.createRef(),r.state={searchInput:"",showInfo:!1},r.props.onSearchOrgs([]),r}return Object(E.a)(t,e),Object(c.a)(t,[{key:"onShowInfo",value:function(){Z.a.info({title:"Organizations Browser Help",width:"50em",content:n.createElement("div",null,n.createElement("p",null,"This is the organizations browser..."))})}},{key:"doSearch",value:function(){if(null!==this.searchInput.current){var e=this.searchInput.current.value.split(/[\s+]/);this.props.onSearchOrgs(e)}}},{key:"haveSearchInput",value:function(){return!!(this.state.searchInput&&this.state.searchInput.length>0)}},{key:"onSearchInputChange",value:function(){var e;e=this.searchInput.current?this.searchInput.current.value:"",this.setState({searchInput:e})}},{key:"onSubmit",value:function(e){e.preventDefault(),this.doSearch()}},{key:"onSortByChange",value:function(e){this.props.onSortOrgs(e.target.value,this.props.sortDirection)}},{key:"onSortByChange2",value:function(e){this.props.onSortOrgs(e,this.props.sortDirection)}},{key:"onSortDirectionChange",value:function(e){this.props.onSortOrgs(this.props.sortBy,e.target.value)}},{key:"onSortDirectionChange2",value:function(e){this.props.onSortOrgs(this.props.sortBy,e)}},{key:"onFilterChange",value:function(e){this.props.onFilterOrgs(e.target.value)}},{key:"onFilterChange2",value:function(e){this.props.onFilterOrgs(e)}},{key:"onClearSearch",value:function(){null!==this.searchInput.current&&(this.searchInput.current.value="",this.onSearchInputChange(),this.doSearch())}},{key:"renderSearchFeedback",value:function(){return 0===this.props.totalCount?n.createElement("span",null,"No organizations in the system"):0===this.props.filteredCount?n.createElement("span",null,"No organizations found out of"," ",this.props.totalCount," ","available."):this.props.totalCount===this.props.filteredCount?n.createElement("span",null,"Showing all"," ",this.props.totalCount," ","organizations"):n.createElement("span",null,"Showing"," ",this.props.filteredCount," ","out of"," ",this.props.totalCount," ","organizations")}},{key:"renderSearchIcon",value:function(){return this.props.searching?n.createElement(f.a,{type:"loading"}):n.createElement(f.a,{type:"search"})}},{key:"renderSearchBar",value:function(){return n.createElement("form",{id:"searchForm",className:"OrganizationsBrowser-searchBar",onSubmit:this.onSubmit.bind(this)},n.createElement("input",{placeholder:"Search Organizations",onChange:this.onSearchInputChange.bind(this),autoFocus:!0,ref:this.searchInput}),n.createElement(X.a,{disabled:!this.haveSearchInput(),ref:this.searchButton,form:"searchForm",key:"submit",htmlType:"submit"},this.renderSearchIcon()),n.createElement(X.a,{onClick:this.onClearSearch.bind(this),disabled:!this.haveSearchInput(),icon:"close"}))}},{key:"renderHeader",value:function(){return n.createElement(te,null,n.createElement("div",{style:{flex:"1 1 0px",display:"flex",flexDirection:"row",alignItems:"center"}},n.createElement("div",{style:{flex:"0 0 auto"}},n.createElement("span",null,"Browse and Search Organizations"),n.createElement(f.a,{type:"right",style:{margin:"0 4px"}}),n.createElement("span",{style:{fontWeight:"normal",fontStyle:"italic"}},this.renderSearchFeedback())),n.createElement("div",{style:{flex:"1 1 0px",display:"flex",flexDirection:"row",justifyContent:"flex-end"}},n.createElement(v.a,{to:"/newOrganization"},n.createElement(X.a,{icon:"plus-circle"},"Create Organization")),n.createElement(X.a,{shape:"circle",icon:"info",onClick:this.onShowInfo.bind(this)}))))}},{key:"renderSearchFilter",value:function(){return n.createElement("div",null,n.createElement("span",{className:"field-label"},"sort by"),n.createElement($.a,{onChange:this.onSortByChange2.bind(this),defaultValue:this.props.sortBy,style:{width:"8em"},dropdownMatchSelectWidth:!0},n.createElement($.a.Option,{value:"name",key:"name"},"Org name"),n.createElement($.a.Option,{value:"owner",key:"owner"},"Owner"),n.createElement($.a.Option,{value:"created",key:"created"},"Date created")),n.createElement($.a,{onChange:this.onSortDirectionChange2.bind(this),style:{width:"10em"},dropdownMatchSelectWidth:!0,defaultValue:this.props.sortDirection},n.createElement($.a.Option,{value:j.ASCENDING,key:"name"},n.createElement(f.a,{type:"sort-ascending"}),"Ascending"),n.createElement($.a.Option,{value:j.DESCENDING,key:"owner"},n.createElement(f.a,{type:"sort-descending"}),"Descending")),n.createElement("span",{className:"field-label",style:{marginLeft:"10px"}},"filter"),n.createElement($.a,{onChange:this.onFilterChange2.bind(this),defaultValue:this.props.filter,style:{width:"16em"},dropdownMatchSelectWidth:!0},n.createElement($.a.Option,{value:"all",key:"all"},"All"),n.createElement($.a.Option,{value:"owned",key:"owned"},"Owned by you"),n.createElement($.a.Option,{value:"notOwned",key:"notOwned"},"Not owned by you"),n.createElement($.a.Option,{value:"pending",key:"pending"},"Pending request or invitation"),n.createElement($.a.Option,{value:"groupPending",key:"groupPending"},"Pending group requests")))}},{key:"render",value:function(){return n.createElement("div",{className:"OrganizationsBrowser"},this.renderHeader(),n.createElement("div",{className:"searchBarRow"},n.createElement("div",{className:"searchBarCol"},this.renderSearchBar()),n.createElement("div",{className:"sortCol"},this.renderSearchFilter())),n.createElement("div",{className:"bodyRow"},n.createElement("div",{className:"col2"},n.createElement(M,null))))}}]),t}(n.Component),ne=r(18),ae=function(){function e(t){var r=t.url,n=t.token;Object(s.a)(this,e),this.url=r,this.token=n}return Object(c.a)(e,[{key:"makePayload",value:function(e,t){return{version:"1.1",method:"UserProfile."+e,id:String(Math.random()).slice(2),params:[t]}}},{key:"makeEmptyPayload",value:function(e){return{version:"1.1",method:"UserProfile."+e,id:String(Math.random()).slice(2),params:[]}}},{key:"getVersion",value:function(){return fetch(this.url,{method:"POST",mode:"cors",cache:"no-store",headers:{Authorization:this.token,"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(this.makeEmptyPayload("version"))}).then(function(e){if(200!==e.status)throw new Error("User profile request error: "+e.status+", "+e.statusText);return e.json()})}},{key:"getUserProfile",value:function(e){return fetch(this.url,{method:"POST",mode:"cors",cache:"no-store",headers:{Authorization:this.token,"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(this.makePayload("get_user_profile",[e]))}).then(function(e){if(200!==e.status)throw new Error("User profile request error: "+e.status+", "+e.statusText);return e.json()}).then(function(e){return e.result[0][0]})}},{key:"getUserProfiles",value:function(e){return fetch(this.url,{method:"POST",mode:"cors",cache:"no-store",headers:{Authorization:this.token,"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(this.makePayload("get_user_profile",e))}).then(function(e){if(200!==e.status)throw new Error("User profile request error: "+e.status+", "+e.statusText);return e.json()}).then(function(e){return e.result[0]})}}]),e}();!function(e){e[e.ASCENDING=0]="ASCENDING",e[e.DESCENDING=1]="DESCENDING"}(J||(J={}));var ie=function(){function e(t){var r=t.token,n=t.url;Object(s.a)(this,e),this.token=r,this.url=n}return Object(c.a)(e,[{key:"getInfo",value:function(){return fetch(this.url+"/",{headers:{Authorization:this.token,Accept:"application/json"},mode:"cors"}).then(function(e){return e.json()}).then(function(e){return e})}},{key:"groupExists",value:function(e){return fetch(this.url+"/group/"+e+"/exists").then(function(e){return e.json()}).then(function(e){return e})}},{key:"getGroups",value:function(){var e=this,t=(new Date).getTime();return fetch(this.url+"/group",{headers:{Authorization:this.token,Accept:"application/json"},mode:"cors"}).then(function(e){return e.json()}).then(function(r){console.log("perf: just groups",(new Date).getTime()-t),t=(new Date).getTime();var n=r.filter(function(e){return"Organization"===e.type});return Promise.all(n.map(function(t){return e.getGroupById(t.id)}))}).then(function(e){return console.log("perf: full groups",(new Date).getTime()-t),e})}},{key:"getGroupById",value:function(e){return fetch(this.url+"/group/"+e,{headers:{Authorization:this.token,Accept:"application/json"},mode:"cors"}).then(function(e){return 404===e.status?null:e.json()}).then(function(e){return e})}},{key:"createGroup",value:function(e){return fetch(this.url+"/group/"+e.id,{headers:{Authorization:this.token,Accept:"application/json","Content-Type":"application/json"},mode:"cors",method:"PUT",body:JSON.stringify({name:e.name,custom:{gravatarhash:e.gravatarhash},type:e.type,description:e.description})}).then(function(e){return e.json()}).then(function(e){return e})}},{key:"updateGroup",value:function(e,t){return fetch(this.url+"/group/"+e+"/update",{headers:{Authorization:this.token,Accept:"application/json","Content-Type":"application/json"},mode:"cors",method:"PUT",body:JSON.stringify({name:t.name,custom:{gravatarhash:t.gravatarhash},type:"Organization",description:t.description})}).then(function(e){if(204!==e.status)throw new Error("Unexpected response: "+e.status+" : "+e.statusText)})}},{key:"getGroupRequests",value:function(e,t){var r=new URLSearchParams;return t.includeClosed&&r.append("closed","closed"),t.sortDirection&&(t.sortDirection===J.DESCENDING?r.append("order","desc"):r.append("order","asc")),t.startAt&&r.append("excludeupto",String(t.startAt.getTime())),fetch(this.url+"/group/"+e+"/requests?"+t.toString(),{headers:{Authorization:this.token,Accept:"application/json","Content-Type":"application/json"},mode:"cors",method:"GET"}).then(function(e){if(200!==e.status)throw new Error("Unexpected response: "+e.status+" : "+e.statusText);return e.json()})}},{key:"getTargetedRequests",value:function(e){var t=new URLSearchParams;return e.includeClosed&&t.append("closed","closed"),e.sortDirection&&(e.sortDirection===J.DESCENDING?t.append("order","desc"):t.append("order","asc")),e.startAt&&t.append("excludeupto",String(e.startAt.getTime())),fetch(this.url+"/request/targeted?"+e.toString(),{headers:{Authorization:this.token,Accept:"application/json","Content-Type":"application/json"},mode:"cors",method:"GET"}).then(function(e){if(200!==e.status)throw new Error("Unexpected response: "+e.status+" : "+e.statusText);return e.json()})}},{key:"getCreatedRequests",value:function(e){var t=new URLSearchParams;return e.includeClosed&&t.append("closed","closed"),e.sortDirection&&(e.sortDirection===J.DESCENDING?t.append("order","desc"):t.append("order","asc")),e.startAt&&t.append("excludeupto",String(e.startAt.getTime())),fetch(this.url+"/request/created?"+e.toString(),{headers:{Authorization:this.token,Accept:"application/json","Content-Type":"appcliation/json"},mode:"cors",method:"GET"}).then(function(e){if(200!==e.status)throw new Error("Unexpected response: "+e.status+" : "+e.statusText);return e.json()})}},{key:"requestMembership",value:function(e){return fetch(this.url+"/group/"+e.groupId+"/requestmembership",{headers:{Authorization:this.token,Accept:"application/json","Content-Type":"application/json"},mode:"cors",method:"POST"}).then(function(e){if(200!==e.status)throw new Error("Unexpected response: "+e.status+" : "+e.statusText);return e.json()}).then(function(e){return e})}},{key:"cancelRequest",value:function(e){var t=e.requestId;return fetch(this.url+"/request/id/"+t+"/cancel",{headers:{Authorization:this.token,Accept:"application/json","Content-Type":"application/json"},mode:"cors",method:"PUT"}).then(function(e){if(200!==e.status)throw new Error("Unexpected response: "+e.status);return e.json()}).then(function(e){return e})}},{key:"acceptRequest",value:function(e){var t=e.requestId;return fetch(this.url+"/request/id/"+t+"/accept",{headers:{Authorization:this.token,Accept:"application/json","Content-Type":"application/json"},mode:"cors",method:"PUT"}).then(function(e){if(200!==e.status)throw new Error("Unexpected response: "+e.status);return e.json()}).then(function(e){return e})}},{key:"denyRequest",value:function(e){var t=e.requestId;return fetch(this.url+"/request/id/"+t+"/deny",{headers:{Authorization:this.token,Accept:"application/json","Content-Type":"application/json"},mode:"cors",method:"PUT"}).then(function(e){if(200!==e.status)throw new Error("Unexpected response: "+e.status);return e.json()}).then(function(e){return e})}}]),e}();var oe=function(){function e(t){Object(s.a)(this,e),this.params=t,this.cachedOrgs=null}return Object(c.a)(e,[{key:"getPendingRequests",value:function(){var e=new ie({url:this.params.groupsServiceURL,token:this.params.token});return Promise.all([e.getCreatedRequests({includeClosed:!1,sortDirection:J.DESCENDING,startAt:new Date(0)}).then(function(e){return e}),e.getTargetedRequests({includeClosed:!1,sortDirection:J.DESCENDING,startAt:new Date(0)}).then(function(e){return e})]).then(function(e){var t=Object(ne.a)(e,2);return{requests:t[0],invitations:t[1]}})}},{key:"groupRequestToGroupRequest",value:function(e){var t=this;var r=new ae({url:this.params.userProfileServiceURL,token:this.params.token}),n=[e.requester];return e.targetuser&&n.push(e.targetuser),r.getUserProfiles(n).then(function(r){return{id:e.id,groupId:e.groupid,requester:t.profileToUser(r[0]),type:(e.type,N.JOIN_GROUP_REQUEST),status:(e.status,y.OPEN),subjectUser:r[1]?t.profileToUser(r[1]):null,subjectWorkspaceId:e.targetws||null,createdAt:new Date(e.createdate),expireAt:new Date(e.expiredate),modifiedAt:new Date(e.moddate)}})}},{key:"getPendingGroupRequests",value:function(e){var t=this;return new ie({url:this.params.groupsServiceURL,token:this.params.token}).getGroupRequests(e,{includeClosed:!1,sortDirection:J.DESCENDING,startAt:new Date(0)}).then(function(e){return Promise.all(e.map(function(e){return t.groupRequestToGroupRequest(e)}))})}},{key:"groupToOrg",value:function(e,t){var r=this;e.id,e.name,e.owner,e.description,e.createdate,e.moddate;t===e.owner?D.OWNER:D.VIEW;var n=new ae({url:this.params.userProfileServiceURL,token:this.params.token}),a=[];return e.members&&(a=e.members.slice()),e.admins&&(a=a.concat(e.admins)),a.push(e.owner),this.getPendingRequests().then(function(i){var o=i.requests,s=i.invitations,c=new Map;o.forEach(function(e){"Request group membership"===e.type&&e.requester===t&&c.set(e.groupid,e)});var u=new Map;return s.forEach(function(e){"Invite to group"===e.type&&e.targetuser===t&&u.set(e.groupid,e)}),n.getUserProfiles(a).then(function(t){var n=t.reduce(function(e,t){return e.set(t.user.username,t),e},new Map),a=n.get(e.owner);if(!a)throw new Error("No profile for owner!");var i,o,s=(e.members||[]).map(function(e){var t=n.get(e);if("undefined"===typeof t)throw new Error("Member without profile!");return r.profileToUser(t)}).sort(function(e,t){return e.realname.localeCompare(t.realname)}),l=(e.admins||[]).map(function(e){var t=n.get(e);if("undefined"===typeof t)throw new Error("Admin without profile");return r.profileToUser(t)});return i=r.params.username===e.owner?{type:D.OWNER}:e.admins.indexOf(r.params.username)>=0?{type:D.ADMIN}:e.members.indexOf(r.params.username)>=0?{type:D.MEMBER}:c.has(e.id)?{type:D.MEMBER_REQUEST_PENDING,requestId:c.get(e.id).id}:u.has(e.id)?{type:D.MEMBER_INVITATION_PENDING,requestId:u.get(e.id).id}:{type:D.VIEW},o=function(){return i.type===D.ADMIN||i.type===D.OWNER?r.getPendingGroupRequests(e.id).then(function(t){return{id:e.id,name:e.name,gravatarHash:e.custom&&e.custom.gravatarhash||null,description:e.description,createdAt:new Date(e.createdate),modifiedAt:new Date(e.moddate),owner:r.profileToUser(a),relation:i,members:s,admins:l,adminRequests:t}}):Promise.resolve({id:e.id,name:e.name,gravatarHash:e.custom&&e.custom.gravatarhash||null,description:e.description,createdAt:new Date(e.createdate),modifiedAt:new Date(e.moddate),owner:r.profileToUser(a),relation:i,members:s,admins:l,adminRequests:[]})},new Promise(function(e,t){try{return e(o())}catch(r){t(r)}})})})}},{key:"getPendingAdminRequests",value:function(e){var t=this;return Promise.all(e.map(function(e){return t.getPendingGroupRequests(e).then(function(t){return{groupId:e,requests:t}})})).then(function(e){var t=new Map;return e.forEach(function(e){var r=e.groupId,n=e.requests;t.set(r,n)}),t})}},{key:"groupsToOrgs",value:function(e,t){var r=this,n=new ae({url:this.params.userProfileServiceURL,token:this.params.token}),a=e.reduce(function(e,t){return e.set(t.owner,!0),t.members.forEach(function(t){return e.set(t,!0)}),t.admins.forEach(function(t){return e.set(t,!0)}),e},new Map).keys(),i=(new Date).getTime(),o=e.filter(function(e){var r=e.owner,n=e.admins;return r===t||n.indexOf(t)>=0}).map(function(e){return e.id});return Promise.all([n.getUserProfiles(Array.from(a)),this.getPendingRequests(),this.getPendingAdminRequests(o)]).then(function(n){var a=Object(ne.a)(n,3),o=a[0],s=a[1],c=s.requests,u=s.invitations,l=a[2];console.log("perf: profiles",(new Date).getTime()-i);var E=o.reduce(function(e,t){return e.set(t.user.username,t),e},new Map),d=new Map;c.forEach(function(e){e.requester===t&&d.set(e.groupid,e)});var m=new Map;return u.forEach(function(e){e.targetuser===t&&m.set(e.groupid,e)}),Promise.all(e.map(function(e){var t,n=e.id,a=e.name,i=e.description,o=e.createdate,s=e.moddate,c=(e.owner,e.members),u=e.admins,p=e.custom.gravatarhash;return t=r.params.username===e.owner?{type:D.OWNER}:e.admins.indexOf(r.params.username)>=0?{type:D.ADMIN}:e.members.indexOf(r.params.username)>=0?{type:D.MEMBER}:d.has(e.id)?{type:D.MEMBER_REQUEST_PENDING,requestId:d.get(e.id).id}:m.has(e.id)?{type:D.MEMBER_INVITATION_PENDING,requestId:m.get(e.id).id}:{type:D.VIEW},{id:n,name:a,description:i,gravatarHash:p||null,owner:r.profileToUser(E.get(e.owner)),createdAt:new Date(o),modifiedAt:new Date(s),relation:t,members:c.map(function(e){return r.profileToUser(E.get(e))}),admins:u.map(function(e){return r.profileToUser(E.get(e))}),adminRequests:l.has(n)?l.get(n):[]}}))})}},{key:"getOrgs",value:function(e){var t=this;return this.cachedOrgs?Promise.resolve(this.cachedOrgs):new ie({url:this.params.groupsServiceURL,token:this.params.token}).getGroups().then(function(r){return t.groupsToOrgs(r,e)})}},{key:"queryOrgs",value:function(e){(new Date).getTime();return this.getOrgs(e.username).then(function(t){return{organizations:function(e,t,r){var n=r===j.ASCENDING?1:-1;switch(t){case"created":return e.slice().sort(function(e,t){return n*(e.createdAt.getTime()-t.createdAt.getTime())});case"name":return e.slice().sort(function(e,t){return n*e.name.localeCompare(t.name)});case"owner":return e.slice().sort(function(e,t){return n*e.owner.username.localeCompare(t.owner.username)});default:return console.warn("unimplemented sort field: "+t),e}}(function(e,t){var r=t.map(function(e){return new RegExp(e,"i")});return e.filter(function(e){return 0===t.length||r.every(function(t){return t.test(e.name)||t.test(e.owner.username)||t.test(e.owner.realname)})})}(function(e,t,r){switch(t){case"all":return e;case"owned":return e.filter(function(e){return e.owner.username===r});case"notOwned":return e.filter(function(e){return e.owner.username!==r});case"pending":return e.filter(function(e){return e.relation.type===D.MEMBER_INVITATION_PENDING||e.relation.type===D.MEMBER_REQUEST_PENDING});case"groupPending":return e.filter(function(e){return(e.relation.type===D.ADMIN||e.relation.type===D.OWNER)&&e.adminRequests&&e.adminRequests.length>0});default:return console.warn("unknown filter : "+t),e}}(t,e.filter,e.username),e.searchTerms),e.sortBy,e.sortDirection),total:t.length}})}},{key:"profileToUser",value:function(e){return{username:e.user.username,realname:e.user.realname,city:e.profile.userdata.city,state:e.profile.userdata.state,country:e.profile.userdata.country,organization:e.profile.userdata.organization,avatarOption:e.profile.userdata.avatarOption,gravatarHash:e.profile.synced.gravatarHash,gravatarDefault:e.profile.userdata.gravatarDefault}}},{key:"getOrg",value:function(e){var t=this;return new ie({url:this.params.groupsServiceURL,token:this.params.token}).getGroupById(e).then(function(e){return t.groupToOrg(e,t.params.username)})}},{key:"getGroup",value:function(e){return 0===e.length?Promise.reject(new Error("Group id may not be an empty string")):new ie({url:this.params.groupsServiceURL,token:this.params.token}).getGroupById(e).then(function(e){return e})}},{key:"groupExists",value:function(e){return new ie({url:this.params.groupsServiceURL,token:this.params.token}).groupExists(e).then(function(e){return e.exists})}},{key:"addOrg",value:function(e,t){var r=this,n=new ie({url:this.params.groupsServiceURL,token:this.params.token});return e.id.error&&e.id.error.type===T.ERROR||e.name.error&&e.name.error.type===T.ERROR||e.gravatarHash.error&&e.gravatarHash.error.type===T.ERROR||e.description.error&&e.description.error.type===T.ERROR?Promise.reject(new Error("One or more fields are invalid")):n.createGroup({id:e.id.value,name:e.name.value,gravatarhash:e.gravatarHash.value,description:e.description.value,type:"Organization"}).then(function(e){return r.groupToOrg(e,t)})}},{key:"updateOrg",value:function(e,t){return new ie({url:this.params.groupsServiceURL,token:this.params.token}).updateGroup(e,{name:t.name,gravatarhash:t.gravatarHash,description:t.description})}},{key:"requestMembershipToGroup",value:function(e){var t=this;return new ie({url:this.params.groupsServiceURL,token:this.params.token}).requestMembership({groupId:e}).then(function(e){return t.groupRequestToGroupRequest(e)}).catch(function(e){throw console.log("err???",e),e})}},{key:"cancelRequest",value:function(e){var t=this;return new ie({url:this.params.groupsServiceURL,token:this.params.token}).cancelRequest({requestId:e}).then(function(e){return t.groupRequestToGroupRequest(e)})}},{key:"acceptRequest",value:function(e){var t=this;return new ie({url:this.params.groupsServiceURL,token:this.params.token}).acceptRequest({requestId:e}).then(function(e){return t.groupRequestToGroupRequest(e)})}},{key:"denyRequest",value:function(e){var t=this;return new ie({url:this.params.groupsServiceURL,token:this.params.token}).denyRequest({requestId:e}).then(function(e){return t.groupRequestToGroupRequest(e)})}},{key:"validateOrgId",value:function(e){return se.validateOrgId(e)}},{key:"validateOrgName",value:function(e){return se.validateOrgName(e)}},{key:"validateOrgDescription",value:function(e){return se.validateOrgDescription(e)}}]),e}(),se=function(){function e(){Object(s.a)(this,e)}return Object(c.a)(e,null,[{key:"validateOrgId",value:function(e){if(0===e.length)return[e,{type:T.ERROR,message:"Organization id may not be empty"}];if(e.match(/\s/))return[e,{type:T.ERROR,message:"Organization id may not contain a space"}];if(e.length>100)return[e,{type:T.ERROR,message:"Organization id may not be longer than 100 characters"}];return e.match(/^[a-zA-Z0-9_]+$/)?[e,{type:T.NONE}]:[e,{type:T.ERROR,message:"Organization id may only contain alphanumeric (a-z, A-Z, 0-9) and underscore (_)"}]}},{key:"validateOrgName",value:function(e){return 0===e.length?[e,{type:T.ERROR,message:"Organization name may not be empty"}]:e.length>256?[e,{type:T.ERROR,message:"Organization name may not be longer than 256 characters"}]:[e,{type:T.NONE}]}},{key:"validateOrgGravatarHash",value:function(e){return 0===e.length?[e,{type:T.NONE}]:e.length>32?[e,{type:T.ERROR,message:"Organization gravatar hash may not be longer than 32 characters"}]:[e,{type:T.NONE}]}},{key:"validateOrgDescription",value:function(e){return 0===e.length?[e,{type:T.ERROR,message:"Organization description may not be empty"}]:e.length>4096?[e,{type:T.ERROR,message:"Organization name may not be longer than 4,096 characters"}]:[e,{type:T.NONE}]}}]),e}(),ce=function(){function e(){Object(s.a)(this,e)}return Object(c.a)(e,null,[{key:"makeEmptyEditableOrganization",value:function(){return{id:{value:"",status:k.NONE,error:{type:T.NONE}},name:{value:"",status:k.NONE,error:{type:T.NONE}},gravatarHash:{value:"",status:k.NONE,error:{type:T.NONE}},description:{value:"",status:k.NONE,error:{type:T.NONE}}}}}]),e}();function ue(e){return{type:H.VIEW_ORG_JOIN_REQUEST_ERROR,error:e}}function le(e){return{type:H.VIEW_ORG_CANCEL_JOIN_REQUEST_ERROR,error:e}}function Ee(e){return function(t,r){t({type:H.VIEW_ORG_FETCH_START});var n=r(),a=n.auth.authorization,i=a.token,o=a.username,s=n.app.config;new oe({token:i,username:o,groupsServiceURL:s.services.Groups.url,userProfileServiceURL:s.services.UserProfile.url,workspaceServiceURL:s.services.Workspace.url}).getOrg(e).then(function(e){console.log("got org!",e),t(function(e){return{type:H.VIEW_ORG_FETCH_SUCCESS,organization:e}}(e))}).catch(function(e){var r;t((r={code:e.name,message:e.message},{type:H.VIEW_ORG_FETCH_ERROR,error:r}))})}}function de(){return function(e,t){var r=t(),n=r.auth.authorization,a=n.token,i=n.username,o=r.app.config,s=r.viewOrg.organization,c=new oe({token:a,username:i,groupsServiceURL:o.services.Groups.url,userProfileServiceURL:o.services.UserProfile.url,workspaceServiceURL:o.services.Workspace.url});"undefined"!==typeof s?c.requestMembershipToGroup(s.id).then(function(){e({type:H.VIEW_ORG_JOIN_REQUEST_SUCCESS}),e(Ee(s.id))}).catch(function(t){e(ue({type:T.ERROR,message:t.message}))}):e(ue({type:T.ERROR,message:"Org not currently defined"}))}}function me(e){return function(t,r){t({type:H.VIEW_ORG_JOIN_REQUEST_START});var n=r(),a=n.auth.authorization,i=a.token,o=a.username,s=n.app.config,c=n.viewOrg.organization,u=new oe({token:i,username:o,groupsServiceURL:s.services.Groups.url,userProfileServiceURL:s.services.UserProfile.url,workspaceServiceURL:s.services.Workspace.url});"undefined"!==typeof c?u.cancelRequest(e).then(function(e){t({type:H.VIEW_ORG_CANCEL_JOIN_REQUEST_SUCCESS}),t(Ee(e.groupId))}).catch(function(e){t(le({type:T.ERROR,message:e.message}))}):t(le({type:T.ERROR,message:"Org not currently defined"}))}}function pe(e,t){return{type:H.SEARCH_ORGS_SUCCESS,organizations:e,totalCount:t}}function he(e){return{type:H.SEARCH_ORGS_ERROR,error:e}}function Oe(e){return function(t,r){t(function(e){return{type:H.SEARCH_ORGS_START,searchTerms:e}}(e)),t({type:H.VIEW_ORG_STOP});var n=r(),a=n.browseOrgs,i=a.sortBy,o=a.sortDirection,s=a.filter,c=n.auth.authorization,u=c.token,l=c.username,E=n.app.config;return new oe({token:u,username:l,groupsServiceURL:E.services.Groups.url,userProfileServiceURL:E.services.UserProfile.url,workspaceServiceURL:E.services.Workspace.url}).queryOrgs({searchTerms:e,sortBy:i,sortDirection:o,filter:s,username:l}).then(function(e){var r=e.organizations,n=e.total;t(pe(r,n))}).catch(function(e){t(he({code:e.name,message:e.message}))})}}function Re(e,t){return function(r,n){r(function(e,t){return{type:H.SORT_ORGS_START,sortBy:e,sortDirection:t}}(e,t));var a=n(),i=a.browseOrgs,o=i.searchTerms,s=i.filter,c=a.auth.authorization,u=c.token,l=c.username,E=a.app.config;return new oe({token:u,username:l,groupsServiceURL:E.services.Groups.url,userProfileServiceURL:E.services.UserProfile.url,workspaceServiceURL:E.services.Workspace.url}).queryOrgs({searchTerms:o,sortBy:e,sortDirection:t,filter:s,username:l}).then(function(e){var t=e.organizations,n=e.total;r(pe(t,n))}).catch(function(e){r(he({code:e.name,message:e.message}))})}}function ge(e){return function(t,r){t(function(e){return{type:H.FILTER_ORGS_START,filter:e}}(e));var n=r(),a=n.browseOrgs,i=a.searchTerms,o=a.sortBy,s=a.sortDirection,c=n.auth.authorization,u=c.token,l=c.username,E=n.app.config;return new oe({token:u,username:l,groupsServiceURL:E.services.Groups.url,userProfileServiceURL:E.services.UserProfile.url,workspaceServiceURL:E.services.Workspace.url}).queryOrgs({searchTerms:i,sortBy:o,sortDirection:s,filter:e,username:l}).then(function(e){var r=e.organizations,n=e.total;t(pe(r,n))}).catch(function(e){t(he({code:e.name,message:e.message}))})}}var ve=Object(h.b)(function(e){var t=e.browseOrgs;return{totalCount:t.totalCount,filteredCount:t.filteredCount,sortBy:t.sortBy,sortDirection:t.sortDirection,filter:t.filter,searching:t.searching}},function(e){return{onSearchOrgs:function(t){e(Oe(t))},onSortOrgs:function(t,r){e(Re(t,r))},onFilterOrgs:function(t){e(ge(t))}}})(re);function fe(e){return{type:H.ADD_ORG_ERROR,error:e}}function _e(){return{type:H.ADD_ORG_EVALUATE_ERRORS}}function Se(e,t){return{type:H.ADD_ORG_UPDATE_ID_ERROR,id:e,error:t}}function Ae(){return function(e,t){e({type:H.ADD_ORG_EDIT_START}),e(De())}}function Te(){return function(e,t){e({type:H.ADD_ORG_START});var r=t(),n=r.auth.authorization,a=n.token,i=n.username,o=r.addOrg.newOrganization,s=r.app.config,c=new oe({token:a,username:i,groupsServiceURL:s.services.Groups.url,userProfileServiceURL:s.services.UserProfile.url,workspaceServiceURL:s.services.Workspace.url});o?c.addOrg(o,i).then(function(t){e(function(e){return{type:H.ADD_ORG_SUCCESS,organization:e}}(t))}).catch(function(t){console.error("error adding",o,t),e(fe({code:"invalid",message:t.message}))}):e(fe({code:"app",message:"The new organization data does not yet exist"}))}}function De(){return function(e,t){var r=t().addOrg.newOrganization;t().addOrg;r&&r.name.status===k.EDITED_OK&&r.id.status===k.EDITED_OK&&r.gravatarHash.status===k.EDITED_OK&&r.description.status===k.EDITED_OK?e({type:H.ADD_ORG_EVALUATE_OK}):e(_e())}}function Ne(e){return function(t){var r=se.validateOrgName(e),n=Object(ne.a)(r,2),a=n[0],i=n[1];i.type===T.ERROR?t(function(e,t){return{type:H.ADD_ORG_UPDATE_NAME_ERROR,name:e,error:t}}(a,i)):t(function(e){return{type:H.ADD_ORG_UPDATE_NAME_SUCCESS,name:e}}(a)),t(De())}}function ye(e){return function(t){var r,n=se.validateOrgGravatarHash(e),a=Object(ne.a)(n,2),i=a[0],o=a[1];o.type===T.ERROR?t(function(e,t){return{type:H.ADD_ORG_UPDATE_GRAVATAR_HASH_ERROR,gravatarHash:e,error:t}}(i,o)):t((r=i,{type:H.ADD_ORG_UPDATE_GRAVATAR_HASH_SUCCESS,gravatarHash:r})),t(De())}}function Ie(e){return function(t,r){var n=se.validateOrgId(e),a=Object(ne.a)(n,2),i=a[0],o=a[1];if(o.type===T.ERROR)return t(Se(i,o)),void t(De());(function(e){var t=e.auth.authorization,r=t.token,n=t.username,a=e.app.config;return new oe({token:r,username:n,groupsServiceURL:a.services.Groups.url,userProfileServiceURL:a.services.UserProfile.url,workspaceServiceURL:a.services.Workspace.url})})(r()).groupExists(i).then(function(e){var r;t(e?Se(i,{type:T.ERROR,message:"This org id is already in use"}):(r=i,{type:H.ADD_ORG_UPDATE_ID_SUCCESS,id:r})),t(De())})}}function we(e){return function(t,r){var n=r(),a=n.auth.authorization,i=a.token,o=a.username,s=n.app.config,c=new oe({token:i,username:o,groupsServiceURL:s.services.Groups.url,userProfileServiceURL:s.services.UserProfile.url,workspaceServiceURL:s.services.Workspace.url}).validateOrgDescription(e),u=Object(ne.a)(c,2),l=u[0],E=u[1];E.type===T.ERROR?t(function(e,t){return{type:H.ADD_ORG_UPDATE_DESCRIPTION_ERROR,description:e,error:t}}(l,E)):t(function(e){return{type:H.ADD_ORG_UPDATE_DESCRIPTION_SUCCESS,description:e}}(l)),t(De())}}var Ue=r(49),Ce=r.n(Ue),be=r(70),Ge=r.n(be),ke=(r(211),function(e){function t(e){var r;return Object(s.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={cancelToBrowser:!1},r.gravatarEmail=n.createRef(),r.origin=document.location.origin,r.props.onAddOrgEdit(),r}return Object(E.a)(t,e),Object(c.a)(t,[{key:"onShowInfo",value:function(){Z.a.info({title:"New Organization Editor Help",width:"50em",content:n.createElement("div",null,n.createElement("p",null,"This is the new organizations editor..."))})}},{key:"onGravatarEmailSync",value:function(){var e;e=this.gravatarEmail.current?this.gravatarEmail.current.value:"n/a";var t=Ge()(e);this.props.onUpdateGravatarHash(t)}},{key:"onClickCancelToBrowser",value:function(){var e=this;if(this.isModified()){Z.a.confirm({title:"Leave the editor?",content:n.createElement("div",null,n.createElement("p",null,"You have entered information for this new organization."),n.createElement("p",null,"If you leave the editor without first saving, the new organization ",n.createElement("i",null,"will not be created"),"."),n.createElement("p",null,n.createElement("b",null,"Continue to leave the editor?"))),onOk:function(){e.setState({cancelToBrowser:!0})},onCancel:function(){},okText:"Yes",cancelText:"No"})}else this.setState({cancelToBrowser:!0})}},{key:"onSubmit",value:function(e){e.preventDefault(),this.props.onAddOrg()}},{key:"onNameChange",value:function(e){e.persist(),this.props.onUpdateName(e.target.value)}},{key:"onGravatarHashChange",value:function(e){e.persist(),this.props.onUpdateGravatarHash(e.target.value)}},{key:"onDescriptionChange",value:function(e){e.persist(),this.props.onUpdateDescription(e.target.value)}},{key:"onIdChange",value:function(e){e.persist(),this.props.onUpdateId(e.target.value)}},{key:"canSave",value:function(){return this.props.editState===C.EDITED&&this.props.validationState===G.VALID&&(this.props.saveState===b.NEW||this.props.saveState===b.READY||this.props.saveState===b.SAVED)}},{key:"isModified",value:function(){return this.props.editState===C.EDITED&&this.props.saveState===b.NEW}},{key:"renderForm",value:function(){return n.createElement("form",{id:"newOrganizationForm",className:"editor",onSubmit:this.onSubmit.bind(this)},n.createElement("div",{className:"row"},n.createElement("div",{className:"col1 field-label"},"name"),n.createElement("div",{className:"col2"},n.createElement("input",{value:this.props.newOrganization.name.value||"",onChange:this.onNameChange.bind(this)}),this.props.newOrganization.name.error?n.createElement("span",{style:{color:"red"}},this.props.newOrganization.name.error.message):"")),n.createElement("div",{className:"row gravatarHash"},n.createElement("div",{className:"col1 field-label"},"gravatar hash"),n.createElement("div",{className:"col2"},n.createElement("div",{style:{display:"flex",flexDirection:"row",marginBottom:"4px"}},n.createElement("div",{style:{flex:"1 1 0px"}},n.createElement("input",{ref:this.gravatarEmail,placeholder:"Provide your gravatar-linked email address, if any"})),n.createElement("div",{style:{flex:"0 0 auto"}},n.createElement(X.a,{icon:"arrow-down",style:{height:"100%"},onClick:this.onGravatarEmailSync.bind(this)}))),n.createElement("input",{value:this.props.newOrganization.gravatarHash.value||"",onChange:this.onGravatarHashChange.bind(this)}),this.props.newOrganization.gravatarHash.error?n.createElement("span",{style:{color:"red"}},this.props.newOrganization.gravatarHash.error.message):"")),n.createElement("div",{className:"row"},n.createElement("div",{className:"col1 field-label"},"id"),n.createElement("div",{className:"col2"},n.createElement("input",{value:this.props.newOrganization.id.value||"",onChange:this.onIdChange.bind(this)}),this.props.newOrganization.id.error?n.createElement("span",{style:{color:"red"}},this.props.newOrganization.id.error.message):"")),n.createElement("div",{className:"row",style:{flex:"1 1 0px",minHeight:"30em",maxHeight:"60em"}},n.createElement("div",{className:"col1 field-label"},"description"),n.createElement("div",{className:"col2"},n.createElement("textarea",{value:this.props.newOrganization.description.value||"",onChange:this.onDescriptionChange.bind(this)}),this.props.newOrganization.description.error?n.createElement("div",{style:{color:"red"}},this.props.newOrganization.description.error.message):"")),n.createElement("div",{className:"row"},n.createElement("div",{className:"col1"}),n.createElement("div",{className:"col2"})))}},{key:"getOrgAvatarUrl",value:function(e){if(!e.gravatarHash.value)return"unicorn-64.png";return"https://www.gravatar.com/avatar/"+e.gravatarHash.value+"?s=64&amp;r=pg&d=identicon"}},{key:"renderOrgAvatar",value:function(e){return n.createElement("img",{style:{width:64,height:64},src:this.getOrgAvatarUrl(e)})}},{key:"renderPreview",value:function(){return n.createElement("form",{className:"preview"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col2"},n.createElement("div",{className:"name"},this.props.newOrganization.name.value||""))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col2"},n.createElement("div",{className:"gravatarHash"},this.renderOrgAvatar(this.props.newOrganization)))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col2"},n.createElement("div",{className:"id"},n.createElement("span",{style:{color:"silver"}},this.origin,"/#orgs/organizations/"),this.props.newOrganization.id.value||n.createElement("span",{style:{fontStyle:"italic"}},"organization id here")))),n.createElement("div",{className:"row",style:{flex:"1 1 0px"}},n.createElement("div",{className:"col2"},n.createElement("div",{className:"description",dangerouslySetInnerHTML:{__html:Ce()(this.props.newOrganization.description.value||"")}}))))}},{key:"renderState",value:function(){var e=this.props,t="edit: "+e.editState+", valid: "+e.validationState+", save: "+e.saveState;return n.createElement("span",{style:{marginRight:"10px"}},t)}},{key:"renderHeader",value:function(){var e=this.props.newOrganization.name.value||n.createElement("span",{style:{fontStyle:"italic",color:"gray"}},"org name will appear here when you edit the name field");return n.createElement(te,null,n.createElement("div",{style:{flex:"1 1 0px",display:"flex",flexDirection:"row",alignItems:"center"}},n.createElement("div",{style:{flex:"0 0 auto"}},n.createElement("span",null,n.createElement(f.a,{type:"plus-circle"})," ",'Adding a New Org "',e,'"')),n.createElement("div",{style:{flex:"1 1 0px",display:"flex",flexDirection:"row",justifyContent:"flex-end",alignItems:"center"}},n.createElement(X.a,{icon:"save",form:"newOrganizationForm",key:"submit",disabled:!this.canSave.call(this),htmlType:"submit"},"Save"),n.createElement(X.a,{icon:"undo",type:"danger",onClick:this.onClickCancelToBrowser.bind(this)},"Return to Orgs Browser"),n.createElement(X.a,{shape:"circle",icon:"info",onClick:this.onShowInfo.bind(this)}))))}},{key:"renderLoadingHeader",value:function(){return n.createElement(te,null,n.createElement("div",{style:{flex:"1 1 0px",display:"flex",flexDirection:"row",alignItems:"center"}},n.createElement("div",{style:{flex:"0 0 auto"}},n.createElement("span",null,"Loading New Org Editor..."))))}},{key:"render",value:function(){return this.state.cancelToBrowser?n.createElement(p.a,{push:!0,to:"/organizations"}):this.props.saveState===b.SAVED?n.createElement(p.a,{push:!0,to:"/editOrganization/"+this.props.newOrganization.id.value}):this.props.newOrganization?n.createElement("div",{className:"NewOrganization"},this.renderHeader(),n.createElement("div",{className:"mainRow"},n.createElement("div",{className:"editorColumn"},n.createElement("h3",null,"Editor"),this.renderForm()),n.createElement("div",{className:"previewColumn"},n.createElement("h3",null,"Preview"),this.renderPreview()))):n.createElement("div",{className:"NewOrganization"},this.renderLoadingHeader())}}]),t}(n.Component));var ze=Object(h.b)(function(e){var t=e.addOrg;return{editState:t.editState,saveState:t.saveState,validationState:t.validationState,newOrganization:t.newOrganization}},function(e){return{onAddOrgEdit:function(){e(Ae())},onAddOrg:function(){e(Te())},onUpdateName:function(t){e(Ne(t))},onUpdateGravatarHash:function(t){e(ye(t))},onUpdateId:function(t){e(Ie(t))},onUpdateDescription:function(t){e(we(t))}}})(ke),Pe=(r(213),r(215),function(e){function t(e){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).call(this,e))}return Object(E.a)(t,e),Object(c.a)(t,[{key:"getAvatarUrl",value:function(e){switch(e.avatarOption||"gravatar"){case"gravatar":var t=e.gravatarDefault||"identicon",r=e.gravatarHash;return r?"https://www.gravatar.com/avatar/"+r+"?s=60&amp;r=pg&d="+t:"./nouserpic.png";case"silhouette":case"mysteryman":default:return"./nouserpic.png"}}},{key:"render",value:function(){var e=this.getAvatarUrl(this.props.user);return n.createElement("img",{src:e,style:{width:this.props.size}})}}]),t}(n.Component)),je=(r(217),function(e){function t(e){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).call(this,e))}return Object(E.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return n.createElement("div",{className:"User"},n.createElement("div",{className:"avatarCol"},n.createElement(Pe,{user:this.props.user,size:this.props.avatarSize||30})),n.createElement("div",{className:"infoCol"},n.createElement("div",{className:"name"},n.createElement("a",{href:"#people/"+this.props.user.username,target:"_blank"},this.props.user.realname)," ","\u2768",this.props.user.username,"\u2769"),n.createElement("div",{className:"organization"},this.props.user.organization||n.createElement("i",null,"no organization in user profile")),n.createElement("div",{className:"location"},[this.props.user.city,this.props.user.state,this.props.user.country].filter(function(e){return e}).join(", ")||n.createElement("i",null,"no location information in user profile"))))}}]),t}(n.Component)),He=function(e){function t(e){var r;return Object(s.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={showInfo:!1},r.props.onViewOrg(r.props.id),r}return Object(E.a)(t,e),Object(c.a)(t,[{key:"onJoinClick",value:function(){this.props.onJoinOrg()}},{key:"onCancelJoinRequest",value:function(){if(console.log("canceling join..."),console.log(this.props.organization.relation),this.props.organization){var e=this.props.organization.relation;this.props.onCancelJoinRequest(e.requestId)}}},{key:"onShowInfo",value:function(){Z.a.info({title:"View Organization Help",width:"50em",content:n.createElement("div",null,n.createElement("p",null,"This is the organizations viewer..."))})}},{key:"buildFooter",value:function(){return n.createElement("div",null,this.renderEditRow())}},{key:"renderEditRow",value:function(){if(this.props.organization.owner.username===this.props.username)return n.createElement("p",{style:{textAlign:"center"}},"As the owner of this group, you may ",n.createElement(v.a,{to:"/editOrganization/".concat(this.props.organization.id)},n.createElement(X.a,{icon:"edit"},"Edit"))," it.")}},{key:"renderEditButton",value:function(){if(this.props.organization.owner.username===this.props.username)return n.createElement(v.a,{to:"/editOrganization/".concat(this.props.organization.id)},n.createElement(X.a,{icon:"edit"},"Edit"))}},{key:"renderOrg",value:function(){if(this.props.organization)return n.createElement("div",{className:"org"},n.createElement("div",{className:"nameAndLogo"},n.createElement("div",{className:"avatar"},this.renderOrgAvatar(this.props.organization)),n.createElement("div",{className:"nameAndLink"},n.createElement("div",{className:"name"},this.props.organization.name),n.createElement("div",{className:"id"},n.createElement("span",{className:"label"},"permalink")," ",n.createElement("span",{className:"permalinkBase"},"https://narrative.kbase.us#orgs/"),this.props.organization.id))),n.createElement("div",{className:"description",dangerouslySetInnerHTML:{__html:Ce()(this.props.organization.description||"")}}))}},{key:"getOrgAvatarUrl",value:function(e){if(!e.gravatarHash)return"unicorn-64.png";return"https://www.gravatar.com/avatar/"+e.gravatarHash+"?s=64&amp;r=pg&d=identicon"}},{key:"renderOrgAvatar",value:function(e){return n.createElement("img",{style:{width:64,height:64},src:this.getOrgAvatarUrl(e)})}},{key:"renderRelation",value:function(e){switch(e.relation.type){case D.NONE:return n.createElement("span",null,n.createElement(f.a,{type:"stop"}),"None");case D.VIEW:return n.createElement(_.a,{placement:"bottomRight",mouseEnterDelay:.5,title:"You are not a member of this org, but you may access it; you may request membership"},n.createElement("span",null,n.createElement(f.a,{type:"eye",style:{marginRight:"4px"}}),"Viewer"));case D.MEMBER_REQUEST_PENDING:return n.createElement("div",null,n.createElement("div",null,n.createElement(f.a,{type:"user",style:{color:"orange"},spin:!0}),"Your membership ",n.createElement("b",null,"request")," is pending"),n.createElement("div",null,n.createElement(X.a,{icon:"delete",type:"danger",onClick:this.onCancelJoinRequest.bind(this)},"Cancel Request")));case D.MEMBER_INVITATION_PENDING:return n.createElement("span",null,n.createElement(f.a,{type:"user",style:{color:"blue"}}),"You have been ",n.createElement("b",null,"invited")," to join");case D.MEMBER:return n.createElement("span",null,n.createElement(f.a,{type:"user"}),"Member");case D.ADMIN:return n.createElement("span",null,n.createElement(f.a,{type:"unlock"}),"Admin");case D.OWNER:return n.createElement(_.a,{placement:"bottomRight",mouseEnterDelay:.5,title:"You own this org"},n.createElement("span",null,n.createElement(f.a,{type:"unlock",theme:"filled",style:{marginRight:"4px"}}),"Owner"))}}},{key:"renderMembers",value:function(){var e;if(this.props.organization)return e=0===this.props.organization.members.length?n.createElement("p",{style:{fontStyle:"italic",textAlign:"center"}},"This organization has no members"):this.props.organization.members.map(function(e){return n.createElement(je,{user:e})}),n.createElement("div",{className:"table infoTable"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col0"},n.createElement("div",null,n.createElement("div",{className:"label"},"members"),e))))}},{key:"renderInfo",value:function(){if(this.props.organization)return n.createElement("div",{className:"table infoTable"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col0"},n.createElement("div",null,n.createElement("div",{className:"label"},"proprietor")),n.createElement("div",{className:"ownerTable"},n.createElement("div",{className:"avatarCol"},n.createElement(Pe,{user:this.props.organization.owner,size:60})),n.createElement("div",{className:"proprietorCol"},n.createElement("div",{className:"owner"},n.createElement("a",{href:"#people/"+this.props.organization.owner.username,target:"_blank"},this.props.organization.owner.realname)," ","\u2768",this.props.organization.owner.username,"\u2769"),n.createElement("div",{className:"profileOrganization"},this.props.organization.owner.organization),n.createElement("div",{className:"profileOrganization"},this.props.organization.owner.city,", ",this.props.organization.owner.state,", ",this.props.organization.owner.country))))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col1"},n.createElement("span",{className:"label"},"established")),n.createElement("div",{className:"col2"},n.createElement("div",{className:"createdAt"},Intl.DateTimeFormat("en-US",{month:"long",day:"numeric",year:"numeric"}).format(this.props.organization.createdAt)))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col1"},n.createElement("span",{className:"label"},"last updated")),n.createElement("div",{className:"col2"},n.createElement("div",{className:"modifiedAt"},Intl.DateTimeFormat("en-US",{month:"long",day:"numeric",year:"numeric"}).format(this.props.organization.modifiedAt)))))}},{key:"renderAdminRequestsRow",value:function(e){if(e&&e.relation&&(e.relation.type===D.ADMIN||e.relation.type===D.OWNER))return n.createElement("div",{className:"row"},n.createElement("div",{className:"col1"},n.createElement("span",{className:"label"},"admin")),n.createElement("div",{className:"col2"},n.createElement("div",{className:"relation"},n.createElement("div",null,n.createElement("div",null,n.createElement(f.a,{type:"exclamation-circle",theme:"twoTone",twoToneColor:"orange"})," group has"," ",n.createElement("span",{style:{fontWeight:"bold"}},e.adminRequests.length)," ","pending request",e.adminRequests.length>1?"s":""),n.createElement("div",null,n.createElement(v.a,{to:"/manageGroupRequests/"+this.props.organization.id},n.createElement(X.a,null,"Manage Requests")))))))}},{key:"renderUserRelationship",value:function(){if(this.props.organization)return n.createElement("form",{className:"table infoTable"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col1"},n.createElement("span",{className:"label"},"your relation")),n.createElement("div",{className:"col2"},n.createElement("div",{className:"relation"},this.renderRelation(this.props.organization)))),this.renderAdminRequestsRow(this.props.organization))}},{key:"renderJoinButton",value:function(){if(this.props.organization&&(console.log("relation?",this.props.organization.relation),this.props.organization.relation.type===D.VIEW))return n.createElement(X.a,{onClick:this.onJoinClick.bind(this)},"Join this Organization")}},{key:"renderHeader",value:function(){return n.createElement(te,null,n.createElement("div",{style:{flex:"1 1 0px",display:"flex",flexDirection:"row",alignItems:"center"}},n.createElement("div",{style:{flex:"0 0 auto"}},n.createElement("span",null,'Viewing Org "',this.props.organization&&this.props.organization.name,'"')),n.createElement("div",{style:{flex:"1 1 0px",display:"flex",flexDirection:"row",justifyContent:"flex-end"}},this.renderEditButton(),n.createElement(v.a,{to:"/organizations"},n.createElement(X.a,{type:"danger",icon:"undo"},"Return to Orgs")),this.renderJoinButton(),n.createElement(X.a,{shape:"circle",icon:"info",onClick:this.onShowInfo.bind(this)}))))}},{key:"renderLoadingHeader",value:function(){return n.createElement(te,null,n.createElement("div",{style:{flex:"1 1 0px",display:"flex",flexDirection:"row",alignItems:"center"}},n.createElement("div",{style:{flex:"0 0 auto"}},n.createElement("span",null,"Loading Org..."))))}},{key:"render",value:function(){return"undefined"!==typeof this.props.organization?n.createElement("div",{className:"ViewOrganization"},this.renderHeader(),n.createElement("div",{className:"mainRow"},n.createElement("div",{className:"mainColumn"},this.renderOrg()),n.createElement("div",{className:"infoColumn"},n.createElement("div",{className:"infoBox"},this.renderUserRelationship()),n.createElement("div",{className:"infoBox"},this.renderInfo()),n.createElement("div",{className:"infoBox"},this.renderMembers())))):n.createElement("div",{className:"ViewOrganization"},this.renderLoadingHeader(),"Loading...")}}]),t}(n.Component);var Me=Object(h.b)(function(e,t){var r=e.viewOrg,n=r.state,a=r.organization,i=r.error,o=e.auth.authorization.username;return{id:t.id,state:n,organization:a,error:i,username:o}},function(e){return{onViewOrg:function(t){e(Ee(t))},onJoinOrg:function(){e(de())},onCancelJoinRequest:function(t){e(me(t))}}})(He);function Ve(){return{type:H.EDIT_ORG_EVALUATE_ERRORS}}function qe(e){return{type:H.EDIT_ORG_SAVE_ERROR,error:e}}function xe(e){return function(t,r){var n;t((n=e,{type:H.EDIT_ORG_EDIT_START,id:n}));var a=r(),i=a.auth.authorization,o=i.token,s=i.username,c=a.app.config;return new oe({token:o,username:s,groupsServiceURL:c.services.Groups.url,userProfileServiceURL:c.services.UserProfile.url,workspaceServiceURL:c.services.Workspace.url}).getOrg(e).then(function(e){var r,n={id:{value:e.id,status:k.UNEDITED_OK,error:{type:T.NONE,message:""}},name:{value:e.name,status:k.UNEDITED_OK,error:{type:T.NONE,message:""}},gravatarHash:{value:e.gravatarHash,status:k.UNEDITED_OK,error:{type:T.NONE,message:""}},description:{value:e.description,status:k.UNEDITED_OK,error:{type:T.NONE,message:""}}};t((r=n,{type:H.EDIT_ORG_EDIT_SUCCESS,editedOrganization:r}))}).catch(function(e){var r;console.error("load org error",e),t((r={code:e.name,message:e.message},{type:H.EDIT_ORG_EDIT_ERROR,error:r}))})}}function Le(){return function(e,t){e({type:H.EDIT_ORG_SAVE_START});var r=t(),n=r.auth.authorization,a=n.token,i=n.username,o=r.editOrg,s=o.organizationId,c=o.editedOrganization,u=r.app.config,l=new oe({token:a,username:i,groupsServiceURL:u.services.Groups.url,userProfileServiceURL:u.services.UserProfile.url,workspaceServiceURL:u.services.Workspace.url});if(c){var E={name:c.name.value,gravatarHash:c.gravatarHash.value,description:c.description.value};l.updateOrg(s,E).then(function(){e({type:H.EDIT_ORG_SAVE_SUCCESS})}).catch(function(t){console.error("error adding",c,t),e(qe({code:"invalid",message:t.message}))})}else e(qe({code:"app",message:"The new organization data does not yet exist"}))}}function We(){return function(e,t){var r=t().editOrg.editedOrganization;t().editOrg;r&&(r.name.status===k.EDITED_OK||r.name.status===k.UNEDITED_OK)&&(r.gravatarHash.status===k.EDITED_OK||r.gravatarHash.status===k.UNEDITED_OK)&&(r.description.status===k.EDITED_OK||r.description.status===k.UNEDITED_OK)?e({type:H.EDIT_ORG_EVALUATE_OK}):e(Ve())}}function Be(e){return function(t){var r=se.validateOrgName(e),n=Object(ne.a)(r,2),a=n[0],i=n[1];i.type===T.ERROR?t(function(e,t){return{type:H.EDIT_ORG_UPDATE_NAME_ERROR,name:e,error:t}}(a,i)):t(function(e){return{type:H.EDIT_ORG_UPDATE_NAME_SUCCESS,name:e}}(a)),t(We())}}function Qe(e){return function(t){var r,n=se.validateOrgGravatarHash(e),a=Object(ne.a)(n,2),i=a[0],o=a[1];o.type===T.ERROR?t(function(e,t){return{type:H.EDIT_ORG_UPDATE_GRAVATAR_HASH_ERROR,gravatarHash:e,error:t}}(i,o)):t((r=i,{type:H.EDIT_ORG_UPDATE_GRAVATAR_HASH_SUCCESS,gravatarHash:r})),t(We())}}function Je(e){return function(t,r){var n=r(),a=n.auth.authorization,i=a.token,o=a.username,s=n.app.config,c=new oe({token:i,username:o,groupsServiceURL:s.services.Groups.url,userProfileServiceURL:s.services.UserProfile.url,workspaceServiceURL:s.services.Workspace.url}).validateOrgDescription(e),u=Object(ne.a)(c,2),l=u[0],E=u[1];E.type===T.ERROR?t(function(e,t){return{type:H.EDIT_ORG_UPDATE_DESCRIPTION_ERROR,description:e,error:t}}(l,E)):t(function(e){return{type:H.EDIT_ORG_UPDATE_DESCRIPTION_SUCCESS,description:e}}(l)),t(We())}}r(219);var Fe=function(e){function t(e){var r;return Object(s.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={cancelToBrowser:!1,cancelToViewer:!1},r.gravatarEmail=n.createRef(),r.origin=document.location.origin,r.props.onEditOrgEdit(r.props.id),r}return Object(E.a)(t,e),Object(c.a)(t,[{key:"onShowInfo",value:function(){Z.a.info({title:"Organization Editor Help",width:"50em",content:n.createElement("div",null,n.createElement("p",null,"This is the organizations editor..."))})}},{key:"onGravatarEmailSync",value:function(){var e;e=this.gravatarEmail.current?this.gravatarEmail.current.value:"n/a";var t=Ge()(e);this.props.onUpdateGravatarHash(t)}},{key:"onClickCancelToBrowser",value:function(){var e=this;if(this.isModified()){Z.a.confirm({title:"Leave the editor?",content:n.createElement("div",null,n.createElement("p",null,"You have made changes on this edit form."),n.createElement("p",null,"If you leave the editor without saving, any ",n.createElement("i",null,"changes they will be lost"),"."),n.createElement("p",null,n.createElement("b",null,"Continue to leave the editor?"))),onOk:function(){e.setState({cancelToBrowser:!0})},onCancel:function(){},okText:"Yes",cancelText:"No"})}else this.setState({cancelToBrowser:!0})}},{key:"onClickCancelToViewer",value:function(){var e=this;if(this.isModified()){Z.a.confirm({title:"Leave the editor?",content:n.createElement("div",null,n.createElement("p",null,"You have made changes on this edit form."),n.createElement("p",null,"If you leave the editor without saving, any ",n.createElement("i",null,"changes they will be lost"),"."),n.createElement("p",null,n.createElement("b",null,"Continue to leave the editor?"))),onOk:function(){e.setState({cancelToViewer:!0})},onCancel:function(){},okText:"Yes",cancelText:"No"})}else this.setState({cancelToViewer:!0})}},{key:"onSubmit",value:function(e){e.preventDefault(),this.props.onEditOrgSave()}},{key:"onNameChange",value:function(e){e.persist(),this.props.onUpdateName(e.target.value)}},{key:"onGravatarHashChange",value:function(e){e.persist(),this.props.onUpdateGravatarHash(e.target.value)}},{key:"onDescriptionChange",value:function(e){e.persist(),this.props.onUpdateDescription(e.target.value)}},{key:"onIdChange",value:function(e){e.persist(),console.warn("no updating id, naughty!")}},{key:"canSave",value:function(){return this.props.editState===C.EDITED&&this.props.validationState===G.VALID&&(this.props.saveState===b.NEW||this.props.saveState===b.READY||this.props.saveState===b.SAVED)}},{key:"isModified",value:function(){return this.props.editState===C.EDITED&&(this.props.saveState===b.NEW||this.props.saveState===b.READY)}},{key:"renderForm",value:function(){return n.createElement("form",{id:"editOrganizationForm",className:"editor",onSubmit:this.onSubmit.bind(this)},n.createElement("div",{className:"row"},n.createElement("div",{className:"col1 field-label"},"name"),n.createElement("div",{className:"col2"},n.createElement("input",{value:this.props.editedOrganization.name.value||"",onChange:this.onNameChange.bind(this)}),this.props.editedOrganization.name.error?n.createElement("span",{style:{color:"red"}},this.props.editedOrganization.name.error.message):"")),n.createElement("div",{className:"row gravatarHash"},n.createElement("div",{className:"col1 field-label"},"gravatar hash"),n.createElement("div",{className:"col2"},n.createElement("div",{style:{display:"flex",flexDirection:"row",marginBottom:"4px"}},n.createElement("div",{style:{flex:"1 1 0px"}},n.createElement("input",{ref:this.gravatarEmail,placeholder:"Provide your gravatar-linked email address, if any"})),n.createElement("div",{style:{flex:"0 0 auto"}},n.createElement(X.a,{icon:"arrow-down",style:{height:"100%"},onClick:this.onGravatarEmailSync.bind(this)}))),n.createElement("input",{value:this.props.editedOrganization.gravatarHash.value||"",onChange:this.onGravatarHashChange.bind(this)}),this.props.editedOrganization.gravatarHash.error?n.createElement("span",{style:{color:"red"}},this.props.editedOrganization.gravatarHash.error.message):"")),n.createElement("div",{className:"row"},n.createElement("div",{className:"col1 field-label"},"id"),n.createElement("div",{className:"col2"},n.createElement("input",{value:this.props.editedOrganization.id.value||"",onChange:this.onIdChange.bind(this)}),this.props.editedOrganization.id.error?n.createElement("span",{style:{color:"red"}},this.props.editedOrganization.id.error.message):"")),n.createElement("div",{className:"row",style:{flex:"1 1 0px",minHeight:"30em",maxHeight:"60em"}},n.createElement("div",{className:"col1 field-label"},"description"),n.createElement("div",{className:"col2"},n.createElement("textarea",{value:this.props.editedOrganization.description.value||"",onChange:this.onDescriptionChange.bind(this)}),this.props.editedOrganization.description.error?n.createElement("div",{style:{color:"red"}},this.props.editedOrganization.description.error.message):"")),n.createElement("div",{className:"row"},n.createElement("div",{className:"col1"}),n.createElement("div",{className:"col2"})))}},{key:"getOrgAvatarUrl",value:function(e){if(!e.gravatarHash.value)return"unicorn-64.png";return"https://www.gravatar.com/avatar/"+e.gravatarHash.value+"?s=64&amp;r=pg&d=identicon"}},{key:"renderOrgAvatar",value:function(e){return n.createElement("img",{style:{width:64,height:64},src:this.getOrgAvatarUrl(e)})}},{key:"renderPreview",value:function(){return n.createElement("form",{className:"preview"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col2"},n.createElement("div",{className:"name"},this.props.editedOrganization.name.value||""))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col2"},n.createElement("div",{className:"gravatarHash"},this.renderOrgAvatar(this.props.editedOrganization)))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col2"},n.createElement("div",{className:"id"},n.createElement("span",{style:{color:"silver"}},this.origin,"/#orgs/organizations/"),this.props.editedOrganization.id.value||n.createElement("span",{style:{fontStyle:"italic"}},"organization id here")))),n.createElement("div",{className:"row",style:{flex:"1 1 0px"}},n.createElement("div",{className:"col2"},n.createElement("div",{className:"description",dangerouslySetInnerHTML:{__html:Ce()(this.props.editedOrganization.description.value||"")}}))))}},{key:"renderState",value:function(){var e=this.props,t="edit: "+e.editState+", valid: "+e.validationState+", save: "+e.saveState;return n.createElement("span",{style:{marginRight:"10px"}},t)}},{key:"renderHeader",value:function(){var e=this.props.editedOrganization.name.value||n.createElement("span",{style:{fontStyle:"italic",color:"gray"}},"org name will appear here when you edit the name field");return n.createElement(te,null,n.createElement("div",{style:{flex:"1 1 0px",display:"flex",flexDirection:"row",alignItems:"center"}},n.createElement("div",{style:{flex:"0 0 auto"}},n.createElement("span",null,n.createElement(f.a,{type:"edit"})," ",'Editing Org "',e,'"')),n.createElement("div",{style:{flex:"1 1 0px",display:"flex",flexDirection:"row",justifyContent:"flex-end",alignItems:"center"}},n.createElement(X.a,{icon:"save",form:"editOrganizationForm",key:"submit",disabled:!this.canSave.call(this),htmlType:"submit"},"Save"),n.createElement(X.a,{icon:"undo",type:"danger",onClick:this.onClickCancelToViewer.bind(this)},"Return to this Org"),n.createElement(X.a,{icon:"undo",type:"danger",onClick:this.onClickCancelToBrowser.bind(this)},"Return to Orgs Browser"),n.createElement(X.a,{shape:"circle",icon:"info",onClick:this.onShowInfo.bind(this)}))))}},{key:"renderLoadingHeader",value:function(){return n.createElement(te,null,n.createElement("div",{style:{flex:"1 1 0px",display:"flex",flexDirection:"row",alignItems:"center"}},n.createElement("div",{style:{flex:"0 0 auto"}},n.createElement("span",null,"Loading Org Editor..."))))}},{key:"render",value:function(){return this.state.cancelToBrowser?n.createElement(p.a,{push:!0,to:"/organizations"}):this.state.cancelToViewer?n.createElement(p.a,{push:!0,to:"/viewOrganization/"+this.props.id}):this.props.editedOrganization?n.createElement("div",{className:"EditOrganization"},this.renderHeader(),n.createElement("div",{className:"mainRow"},n.createElement("div",{className:"editorColumn"},n.createElement("h3",null,"Editor"),this.renderForm()),n.createElement("div",{className:"previewColumn"},n.createElement("h3",null,"Preview"),this.renderPreview()))):n.createElement("div",{className:"EditOrganization"},this.renderLoadingHeader())}}]),t}(n.Component);var Ke=Object(h.b)(function(e){var t=e.editOrg;return{editState:t.editState,saveState:t.saveState,validationState:t.validationState,editedOrganization:t.editedOrganization}},function(e){return{onEditOrgEdit:function(t){e(xe(t))},onEditOrgSave:function(){e(Le())},onUpdateName:function(t){e(Be(t))},onUpdateGravatarHash:function(t){e(Qe(t))},onUpdateDescription:function(t){e(Je(t))}}})(Fe),Ye=(r(221),function(e){function t(e){var r;return Object(s.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).tokenRef=n.createRef(),r.props.checkAuth(),r}return Object(E.a)(t,e),Object(c.a)(t,[{key:"onLogoutClick",value:function(){this.props.onRemoveAuthorization()}},{key:"onLoginClick",value:function(){if(null!==this.tokenRef.current){var e=this.tokenRef.current.value;0!==e.length&&this.props.onAddAuthorization(e)}}},{key:"buildAuthForm",value:function(){return n.createElement("div",{className:"Auth-form"},"Token: ",n.createElement("input",{ref:this.tokenRef}),n.createElement(X.a,{icon:"save",htmlType:"submit",onClick:this.onLoginClick.bind(this)},"Assign Token"))}},{key:"buildAuthToolbar",value:function(){return n.createElement("div",{className:"Auth-toolbar"},"Logged in as ",n.createElement("b",null,n.createElement("span",null,this.props.authorization.authorization.realname)," (",n.createElement("span",null,this.props.authorization.authorization.username)),")"," ",n.createElement(X.a,{icon:"logout",onClick:this.onLogoutClick.bind(this)},"Sign out"))}},{key:"buildAuthDev",value:function(){switch(this.props.authorization.status){case I.NONE:case I.CHECKING:return n.createElement("div",null);case I.AUTHORIZED:return n.createElement("div",{className:"Auth Auth-authorized"},this.buildAuthToolbar(),this.props.children);case I.UNAUTHORIZED:return n.createElement("div",{className:"Auth Auth-unauthorized"},n.createElement("p",null,"Not authorized! Enter a user token below"),this.buildAuthForm());case I.ERROR:return n.createElement("div",{className:"Auth Auth-unauthorized"},n.createElement("p",null,"Error"),this.props.authorization.message);default:return n.createElement("div",null)}}},{key:"buildAuthProd",value:function(){switch(this.props.authorization.status){case I.NONE:case I.CHECKING:return n.createElement("div",null);case I.AUTHORIZED:return n.createElement("div",{className:"Auth Auth-authorized"},this.props.children);case I.UNAUTHORIZED:return n.createElement("div",{className:"Auth Auth-unauthorized"},n.createElement("p",null,"Not authorized!"));case I.ERROR:return n.createElement("div",{className:"Auth Auth-error"},n.createElement("p",null,"Error: ??"));default:return n.createElement("div",null)}}},{key:"render",value:function(){return n.createElement("div",{className:"Auth"},this.props.hosted?this.buildAuthProd():this.buildAuthDev())}}]),t}(n.Component)),Ze=r(71),Xe="",$e="api/V2/token",et="api/V2/me",tt=function(){function e(t){var r=t.url;Object(s.a)(this,e),this.url=r}return Object(c.a)(e,[{key:"makePath",value:function(e){return"string"===typeof e?[this.url].concat([e]).join("/"):[this.url].concat(e).join("/")}},{key:"root",value:function(){return fetch(this.makePath([Xe]),{headers:{Accept:"application/json"},mode:"cors"}).then(function(e){return e.json()}).then(function(e){return e})}},{key:"getTokenInfo",value:function(e){return fetch(this.makePath([$e]),{headers:{Accept:"application/json",Authorization:e},mode:"cors"}).then(function(e){if(200!==e.status)throw new Error(e.statusText);return e.json()}).then(function(e){return e})}},{key:"getMe",value:function(e){return fetch(this.makePath([et]),{headers:{Accept:"application/json",Authorization:e},mode:"cors"}).then(function(e){if(200!==e.status)throw new Error(e.statusText);return e.json()}).then(function(e){return e})}}]),e}();function rt(e){return{type:H.AUTH_CHECK_ERROR,error:e}}function nt(e,t,r,n){return{type:H.AUTH_AUTHORIZED,token:e,username:t,realname:r,roles:n}}function at(){return{type:H.AUTH_UNAUTHORIZED}}function it(){return function(e,t){e({type:H.AUTH_CHECK_START});var r=Ze.get("kbase_session");if(r){var n=new tt({url:"/services/auth"});Promise.all([n.getTokenInfo(r),n.getMe(r)]).then(function(t){var n=Object(ne.a)(t,2),a=(n[0],n[1]),i=a.roles.map(function(e){var t=e.id;e.desc;return t});e(nt(r,a.user,a.display,i))}).catch(function(t){console.error("auth check error",t),e(rt({code:"error",message:t.message}))})}else e(at())}}var ot=Object(h.b)(function(e,t){return{authorization:e.auth}},function(e){return{checkAuth:function(){e(it())},onRemoveAuthorization:function(){e(function(e,t){Ze.remove("kbase_session"),e(at())})},onAddAuthorization:function(t){e(function(e){return function(t,r){Ze.set("kbase_session",e);var n=new tt({url:"/services/auth"});Promise.all([n.getTokenInfo(e),n.getMe(e)]).then(function(r){var n=Object(ne.a)(r,2),a=(n[0],n[1]),i=a.roles.map(function(e){var t=e.id;return e.desc,t});t(nt(e,a.user,a.display,i))}).catch(function(e){console.error("auth check error",e),t(rt({code:"error",message:e.message}))})}}(t))}}})(Ye),st=r(56),ct=r.n(st),ut=function e(t){var r=t.name,n=t.onSuccess,a=t.onError;Object(s.a)(this,e),this.name=r,this.onSuccess=n,this.onError=a},lt=function(e){function t(e){var r;return Object(s.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).started=new Date,r.timeout=e.timeout||5e3,r}return Object(E.a)(t,e),t}(ut),Et=function(){function e(t){var r=t.name,n=t.payload,a=t.channel;Object(s.a)(this,e),this.name=r,this.payload=n,this.id=ct()(),this.created=new Date,this.channel=a,this.envelope=null}return Object(c.a)(e,[{key:"getMessage",value:function(){return{envelope:{id:this.id,created:this.created,channel:this.channel},name:this.name,payload:this.payload}}}]),e}(),dt=function(){function e(t){if(Object(s.a)(this,e),this.window=t.window,null===this.window.document)throw new Error("No document");if(null===this.window.document.location)throw new Error("No location");this.host=t.host||this.window.document.location.origin,this.id=t.channelId||ct()(),this.awaitingResponse=new Map,this.waitingListeners=new Map,this.listeners=new Map,this.lastId=0,this.sentCount=0,this.receivedCount=0,this.unwelcomeReceivedCount=0,this.unwelcomeReceivedCountThreshhold=100,this.unwelcomeReceiptWarning=!0,this.unwelcomeReceiptWarningCount=0,this.currentListener=null}return Object(c.a)(e,[{key:"genId",value:function(){return this.lastId+=1,"msg_"+String(this.lastId)}},{key:"receiveMessage",value:function(e){var t=e.data;if(!t)return this.unwelcomeReceivedCount++,void(this.unwelcomeReceiptWarning&&console.warn("No message data; message ignored",e));if(!t.envelope)return this.unwelcomeReceivedCount++,void(this.unwelcomeReceiptWarning&&console.warn("No message envelope, not from KBase; message ignored",e));if(t.envelope.channelId!==this.id)return this.unwelcomeReceivedCount++,void(this.unwelcomeReceiptWarning&&console.warn("Message envelope does not match this channel's id",e));if(this.unwelcomeReceiptWarningCount>this.unwelcomeReceivedCountThreshhold&&(this.unwelcomeReceiptWarning=!1,console.warn("Unwelcome message warning disabled after "+this.unwelcomeReceiptWarningCount+" instances.")),t.envelope.id&&this.awaitingResponse.has(t.envelope.id))try{var r=this.awaitingResponse.get(t.envelope.id);this.awaitingResponse.delete(t.envelope.id),r&&r.handler(t.payload)}catch(a){console.error("Error handling response for message ",t,a)}if(this.waitingListeners.has(t.name)){var n=this.waitingListeners.get(t.name);this.waitingListeners.delete(t.name),n.forEach(function(e){try{e.onSuccess(t.payload)}catch(a){console.error("Error handling listener for message",t,a),e.onError&&e.onError(a)}})}this.listeners.has(t.name)&&this.listeners.get(t.name).forEach(function(e){e.onSuccess||console.warn("no handler for listener!",e);try{e.onSuccess(t.payload)}catch(a){console.error("Error handling listener for message",t,a),e.onError&&e.onError(a)}})}},{key:"listen",value:function(e){this.listeners.has(e.name)||this.listeners.set(e.name,[]),this.listeners.get(e.name).push(e)}},{key:"on",value:function(e,t,r){this.listen(new ut({name:e,onSuccess:t,onError:r}))}},{key:"sendMessage",value:function(e){this.window.postMessage(e.getMessage(),this.host)}},{key:"send",value:function(e,t){var r=new Et({name:e,payload:t,channel:this.id});this.sendMessage(r)}},{key:"sendRequest",value:function(e,t){this.awaitingResponse.set("message.id",{started:new Date,handler:t}),this.sendMessage(e)}},{key:"request",value:function(e,t){var r=this;return new Promise(function(n,a){try{r.sendRequest(new Et({name:e,payload:t,channel:r.id}),function(e){n(e)})}catch(i){a(i)}})}},{key:"startMonitor",value:function(){var e=this;window.setTimeout(function(){var t=(new Date).getTime(),r=!0,n=!1,a=void 0;try{for(var i,o=function(){var r=i.value,n=(c=Object(ne.a)(r,2))[0];0===c[1].filter(function(e){if(e instanceof lt){var r=t-e.started.getTime();if(r>e.timeout){try{e.onError&&e.onError(new Error("timout after "+r))}catch(a){console.error("Error calling error handler",n,a)}return!1}return!0}return!0}).length&&e.waitingListeners.delete(n)},s=e.waitingListeners.entries()[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var c;o()}}catch(u){n=!0,a=u}finally{try{r||null==s.return||s.return()}finally{if(n)throw a}}e.waitingListeners.size>0&&e.startMonitor()},100)}},{key:"listenOnce",value:function(e){this.waitingListeners.has(e.name)||this.waitingListeners.set(e.name,[]),this.waitingListeners.get(e.name).push(e),e.timeout&&this.startMonitor()}},{key:"once",value:function(e,t,r){this.listenOnce(new lt({name:e,onSuccess:t,onError:r}))}},{key:"when",value:function(e,t){var r=this;return new Promise(function(n,a){return r.listenOnce(new lt({name:e,timeout:t,onSuccess:function(e){n(e)},onError:function(e){a(e)}}))})}},{key:"stats",value:function(){return{sent:this.sentCount,received:this.receivedCount}}},{key:"attach",value:function(e){this.window=e}},{key:"start",value:function(){var e=this;this.currentListener=function(t){e.receiveMessage(t)},this.window.addEventListener("message",this.currentListener,!1)}},{key:"stop",value:function(){this.currentListener&&this.window.removeEventListener("message",this.currentListener,!1)}}]),e}(),mt=function(){function e(){Object(s.a)(this,e),this.params=null,this.channel=new dt({window:window,host:document.location.origin})}return Object(c.a)(e,[{key:"getParamsFromIFrame",value:function(){return{channelId:this.channel.id,frameId:ct()(),params:{groupsServiceURL:"services/groups",userProfileServiceURL:"services/user_profile/rpc",workspaceServiceURL:"services/ws"},parentHost:document.location.origin}}}]),e}(),pt=function(){function e(){Object(s.a)(this,e)}return Object(c.a)(e,[{key:"getParamsFromIFrame",value:function(){if(!window.frameElement)return null;if(!window.frameElement.hasAttribute("data-params"))return null;var e=window.frameElement.getAttribute("data-params");return null===e?null:JSON.parse(decodeURIComponent(e))}}]),e}();function ht(e){return{type:H.APP_SUCCESS,config:e}}r(225);var Ot=function(e){function t(e){var r;return Object(s.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).props.onAppStart(),r}return Object(E.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return this.props.status===P.NONE?n.createElement("div",{className:"KBaseIntegration"},"Loading..."):n.createElement("div",{className:"KBaseIntegration"},this.props.children)}}]),t}(n.Component);var Rt=Object(h.b)(function(e,t){return{status:e.app.status}},function(e){return{onAppStart:function(){e(function(e,t){var r=(new pt).getParamsFromIFrame();if(r)e(ht({baseUrl:"",services:{Groups:{url:r.params.groupsServiceURL},UserProfile:{url:r.params.userProfileServiceURL},Workspace:{url:r.params.userProfileServiceURL}}}));else{var n=(new mt).getParamsFromIFrame();e(ht({baseUrl:"",services:{Groups:{url:n.params.groupsServiceURL},UserProfile:{url:n.params.userProfileServiceURL},Workspace:{url:n.params.workspaceServiceURL}}}))}})}}})(Ot);function gt(e){return function(t,r){var n=r(),a=n.auth.authorization,i=a.token,o=a.username,s=n.app.config,c=new oe({token:i,username:o,groupsServiceURL:s.services.Groups.url,userProfileServiceURL:s.services.UserProfile.url,workspaceServiceURL:s.services.Workspace.url});Promise.all([c.getOrg(e),c.getPendingGroupRequests(e)]).then(function(e){var r=Object(ne.a)(e,2),n=r[0],a=r[1];console.log("got requests?",a),t(function(e,t){return{type:H.ADMIN_MANAGE_REQUESTS_SUCCESS,organization:e,requests:t}}(n,a))}).catch(function(e){var r;t((r={code:e.name,message:e.message},{type:H.ADMIN_MANAGE_REQUESTS_ERROR,error:r}))})}}function vt(e){return function(t,r){var n=r(),a=n.auth.authorization,i=a.token,o=a.username,s=n.manageGroupRequestsView,c=n.app.config,u=new oe({token:i,username:o,groupsServiceURL:c.services.Groups.url,userProfileServiceURL:c.services.UserProfile.url,workspaceServiceURL:c.services.Workspace.url});s&&Promise.all([u.acceptRequest(e)]).then(function(e){var r=Object(ne.a)(e,1)[0];t(function(e){return{type:H.ADMIN_MANAGE_REQUESTS_ACCEPT_JOIN_REQUEST_SUCCESS,request:e}}(r)),s.view&&t(gt(s.view.organization.id))}).catch(function(e){var r;t((r={code:e.name,message:e.message},{type:H.ADMIN_MANAGE_REQUESTS_ACCEPT_JOIN_REQUEST_ERROR,error:r}))})}}function ft(e){return function(t,r){var n=r(),a=n.auth.authorization,i=a.token,o=a.username,s=n.manageGroupRequestsView,c=n.app.config,u=new oe({token:i,username:o,groupsServiceURL:c.services.Groups.url,userProfileServiceURL:c.services.UserProfile.url,workspaceServiceURL:c.services.Workspace.url});s&&Promise.all([u.denyRequest(e)]).then(function(e){var r=Object(ne.a)(e,1)[0];t(function(e){return{type:H.ADMIN_MANAGE_REQUESTS_DENY_JOIN_REQUEST_SUCCESS,request:e}}(r)),s.view&&t(gt(s.view.organization.id))}).catch(function(e){var r;t((r={code:e.name,message:e.message},{type:H.ADMIN_MANAGE_REQUESTS_DENY_JOIN_REQUEST_ERROR,error:r}))})}}r(227);var _t=r(255),St=r(253),At=function(e){function t(e){var r;return Object(s.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={cancelToBrowser:!1,cancelToViewer:!1},console.log("props",e),r.props.onStart(r.props.organizationId),r}return Object(E.a)(t,e),Object(c.a)(t,[{key:"onClickCancelToBrowser",value:function(){this.setState({cancelToBrowser:!0})}},{key:"onClickCancelToViewer",value:function(){this.setState({cancelToViewer:!0})}},{key:"onAcceptJoinRequest",value:function(e){this.props.manageGroupRequestsView&&this.props.manageGroupRequestsView.view&&this.props.onAcceptJoinRequest(e)}},{key:"onDenyJoinRequest",value:function(e){this.props.manageGroupRequestsView&&this.props.manageGroupRequestsView.view&&this.props.onDenyJoinRequest(e)}},{key:"onViewProfile",value:function(e){window.open("#people/"+e,"_blank")}},{key:"onShowInfo",value:function(){Z.a.info({title:"Manage Requests Help",width:"50em",content:n.createElement("div",null,n.createElement("p",null,"This is the manage requests tool..."))})}},{key:"renderHeader",value:function(){var e;return e=this.props.manageGroupRequestsView&&this.props.manageGroupRequestsView.view?this.props.manageGroupRequestsView.view.organization.name:"loading...",n.createElement(te,null,n.createElement("div",{style:{flex:"1 1 0px",display:"flex",flexDirection:"row",alignItems:"center"}},n.createElement("div",{style:{flex:"0 0 auto"}},n.createElement("span",null,n.createElement(f.a,{type:"tool"})," ",'Managing Requests for Org "',e,'"')),n.createElement("div",{style:{flex:"1 1 0px",display:"flex",flexDirection:"row",justifyContent:"flex-end",alignItems:"center"}},n.createElement(X.a,{icon:"undo",type:"danger",onClick:this.onClickCancelToViewer.bind(this)},"Return to this Org"),n.createElement(X.a,{icon:"undo",type:"danger",onClick:this.onClickCancelToBrowser.bind(this)},"Return to Orgs Browser"),n.createElement(X.a,{shape:"circle",icon:"info",onClick:this.onShowInfo.bind(this)}))))}},{key:"renderLoadingHeader",value:function(){return n.createElement(te,null,n.createElement("div",{style:{flex:"1 1 0px",display:"flex",flexDirection:"row",alignItems:"center"}},n.createElement("div",{style:{flex:"0 0 auto"}},n.createElement("span",null,"Loading Org Editor..."))))}},{key:"renderRequestType",value:function(e){switch(e){case N.JOIN_GROUP_REQUEST:return"Join Group Request";case N.JOIN_GROUP_INVITE:return"Join Group Invitation";case N.ADD_WORKSPACE_REQUEST:return"Add Workspace Request";case N.ADD_WORKSPACE_INVITE:return"Add Workspace Invitation"}}},{key:"niceElapsed",value:function(e){var t,r,n,a=new Date,i=Math.round((a.getTime()-e.getTime())/1e3),o=Math.abs(i);if(o<7776e3){if(0===o)return"now";o<60?(t=i,r=o,n="second"):o<3600?(t=Math.round(i/60),r=Math.round(o/60),n="minute"):o<86400?(t=Math.round(i/3600),r=Math.round(o/3600),n="hour"):(t=Math.round(i/86400),r=Math.round(o/86400),n="day"),r>1&&(n+="s");var s=null,c=null;return t<0?s="in":t>0&&(c="ago"),(s?s+" ":"")+r+" "+n+(c?" "+c:"")}return a.getFullYear()===a.getFullYear()?Intl.DateTimeFormat("en-US",{month:"short",day:"numeric"}).format(e):Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(e)}},{key:"renderRequestJoinRequest",value:function(e){var t=this,r=n.createElement("span",null,n.createElement(f.a,{type:"user"}),n.createElement(f.a,{type:"arrow-right"}),n.createElement(f.a,{type:"team"})," ","Request to Join Group"),a=[n.createElement(X.a,{type:"primary",style:{margin:"0 5px"},onClick:function(){return t.onAcceptJoinRequest.call(t,e.id)}},"Approve"),n.createElement(X.a,{type:"danger",style:{margin:"0 5px"},onClick:function(){return t.onDenyJoinRequest.call(t,e.id)}},"Deny")];return n.createElement(_t.a,{key:e.id,title:r,hoverable:!0,actions:a,headStyle:{backgroundColor:"rgba(200, 200, 200,0.3"},style:{marginBottom:"10px"}},n.createElement("table",{className:"pendingRequestsTable"},n.createElement("tr",null,n.createElement("th",null,"from"),n.createElement("td",{className:"requester"},n.createElement(je,{user:e.requester,avatarSize:50}))),n.createElement("tr",null,n.createElement("th",null,"sent"),n.createElement("td",{className:"createdAt"},Intl.DateTimeFormat("en-US",{month:"long",day:"numeric",year:"numeric"}).format(e.createdAt))),n.createElement("tr",null,n.createElement("th",null,"expires"),n.createElement("td",{className:"expiresAt"},Intl.DateTimeFormat("en-US",{month:"long",day:"numeric",year:"numeric"}).format(e.expireAt)," (",this.niceElapsed(e.expireAt),")"))))}},{key:"renderInviteJoinRequest",value:function(e){return n.createElement("div",null,"Not yet implemented")}},{key:"renderRequestNarrativeRequest",value:function(e){return n.createElement("div",null,"Not yet implemented")}},{key:"renderInviteNarrativeRequest",value:function(e){return n.createElement("div",null,"Not yet implemented")}},{key:"renderRequest",value:function(e){switch(e.type){case N.JOIN_GROUP_REQUEST:return this.renderRequestJoinRequest(e);case N.JOIN_GROUP_INVITE:return this.renderInviteJoinRequest(e);case N.ADD_WORKSPACE_REQUEST:return this.renderRequestNarrativeRequest(e);case N.ADD_WORKSPACE_INVITE:return this.renderInviteNarrativeRequest(e)}}},{key:"renderRequests",value:function(){var e=this;if(this.props.manageGroupRequestsView&&this.props.manageGroupRequestsView.view)return 0===this.props.manageGroupRequestsView.view.requests.length?n.createElement("p",{style:{textAlign:"center",padding:"10px"}},"No pending requests for this organization"):this.props.manageGroupRequestsView.view.requests.map(function(t){return e.renderRequest(t)})}},{key:"render",value:function(){return this.state.cancelToBrowser?n.createElement(St.a,{push:!0,to:"/organizations"}):this.state.cancelToViewer?n.createElement(St.a,{push:!0,to:"/viewOrganization/"+this.props.organizationId}):n.createElement("div",{className:"ManageGroupRequests"},this.renderHeader(),n.createElement("div",{className:"row"},n.createElement("div",{className:"pendingCol"},n.createElement("h2",null,"Current Pending Requests"),n.createElement("div",{className:"pendingRequests"},this.renderRequests())),n.createElement("div",{className:"historyCol"},n.createElement("h2",null,"Request History"),n.createElement("p",null,"[to be done]"),n.createElement("p",null,'This will show a browesable, searchable, filterable list of "closed" (canceled, accepted, denied) requests. Default shows all in descending date (modified) order'))))}}]),t}(n.Component);var Tt=Object(h.b)(function(e,t){return{manageGroupRequestsView:e.manageGroupRequestsView}},function(e){return{onStart:function(t){e(gt(t))},onAcceptJoinRequest:function(t){e(vt(t))},onDenyJoinRequest:function(t){e(ft(t))}}})(At),Dt=function(){function e(){Object(s.a)(this,e)}return Object(c.a)(e,null,[{key:"makeInitialState",value:function(){return{browseOrgs:{rawOrganizations:[],organizations:[],totalCount:0,filteredCount:0,sortBy:"name",sortDirection:j.ASCENDING,filter:"all",searchTerms:[],selectedOrganizationId:null,searching:!1},auth:{status:I.NONE,message:"",authorization:{token:"",username:"",realname:"",roles:[]}},error:null,app:{status:P.NONE,config:{baseUrl:"",services:{Groups:{url:""},UserProfile:{url:""},Workspace:{url:""}}}},addOrg:{editState:C.NONE,saveState:b.NONE,validationState:G.NONE,newOrganization:ce.makeEmptyEditableOrganization()},updateOrg:{pending:!1},viewOrg:{state:z.NONE},editOrg:{organizationId:"",editState:C.NONE,saveState:b.NONE,validationState:G.NONE,editedOrganization:ce.makeEmptyEditableOrganization()},manageGroupRequestsView:null}}}]),e}();K.a.add(Y.b,Y.a);var Nt=!!window.frameElement,yt=Dt.makeInitialState(),It=Object(O.d)(F,yt,Object(O.c)(Object(O.a)(R.a))),wt=function(e){function t(e){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).call(this,e))}return Object(E.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return a.a.createElement(h.a,{store:It},a.a.createElement(ot,{hosted:Nt},a.a.createElement(Rt,null,a.a.createElement(m.a,{basename:"/orgs/"},a.a.createElement("div",{className:"App"},a.a.createElement("div",{className:"App-body"},a.a.createElement(d.a,{path:"/organizations",component:ve}),a.a.createElement(d.a,{path:"/newOrganization",component:ze}),a.a.createElement(d.a,{path:"/viewOrganization/:id",component:function(e){var t=e.match.params.id;return a.a.createElement(Me,{id:t})}}),a.a.createElement(d.a,{path:"/editOrganization/:id",component:function(e){var t=e.match.params.id;return a.a.createElement(Ke,{id:t})}}),a.a.createElement(d.a,{path:"/manageGroupRequests/:id",component:function(e){var t=e.match.params.id;return a.a.createElement(Tt,{organizationId:t})}}),a.a.createElement(p.a,{from:"/",to:"/organizations",exact:!0})))))))}}]),t}(n.Component);r(245),r(247),r(249);o.a.render(a.a.createElement(wt,null),document.getElementById("root"))}},[[130,2,1]]]);
//# sourceMappingURL=main.3e56a59e.chunk.js.map